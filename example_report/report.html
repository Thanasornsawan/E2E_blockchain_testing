<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets/app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:1,&quot;tests&quot;:26,&quot;passes&quot;:26,&quot;pending&quot;:0,&quot;failures&quot;:0,&quot;testsRegistered&quot;:26,&quot;passPercent&quot;:100,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false,&quot;start&quot;:&quot;2025-02-10T19:19:01.358Z&quot;,&quot;end&quot;:&quot;2025-02-10T19:19:11.691Z&quot;,&quot;duration&quot;:10333},&quot;results&quot;:[{&quot;uuid&quot;:&quot;e511e9f2-8195-44f8-8123-5643972ed121&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;b07994b9-542c-4445-8953-326136585ec2&quot;,&quot;title&quot;:&quot;Performance and Concurrency Tests&quot;,&quot;fullFile&quot;:&quot;/Users/thanasornsawan/E2E_blockchain_testing/test/integration/A_PerformanceTest.test.ts&quot;,&quot;file&quot;:&quot;/test/integration/A_PerformanceTest.test.ts&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;Performance and Concurrency Tests\&quot;&quot;,&quot;fullTitle&quot;:&quot;Performance and Concurrency Tests \&quot;before all\&quot; hook in \&quot;Performance and Concurrency Tests\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:null,&quot;speed&quot;:null,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:null,&quot;code&quot;:&quot;// Get signers and verify we have enough\nconst allSigners = await hardhat_1.ethers.getSigners();\nconsole.log(`Available signers: ${allSigners.length}`);\nif (allSigners.length &lt; REQUIRED_ACCOUNTS) {\n    console.error(`Not enough signers. Required: ${REQUIRED_ACCOUNTS}, Available: ${allSigners.length}`);\n    console.error(\&quot;Please update hardhat.config.ts to include more test accounts\&quot;);\n    this.skip();\n    return;\n}\n[owner, ...users] = allSigners;\nconsole.log(\&quot;Test accounts:\&quot;);\nconsole.log(`Owner: ${owner.address}`);\nusers.slice(0, REQUIRED_ACCOUNTS - 1).forEach((user, index) =&gt; {\n    console.log(`User ${index + 1}: ${user.address}`);\n});\n// Read network config\ntry {\n    const networkConfig = JSON.parse((0, fs_1.readFileSync)((0, path_1.join)(__dirname, &#x27;../config/networks.json&#x27;), &#x27;utf-8&#x27;));\n    addresses = networkConfig.mainnet;\n    console.log(\&quot;Using addresses:\&quot;, addresses);\n}\ncatch (error) {\n    console.error(\&quot;Failed to read network config:\&quot;, error);\n    throw error;\n}\n// Deploy contracts if addresses are missing\nif (!addresses?.lendingProtocol || !addresses?.weth || !addresses?.usdc) {\n    console.log(\&quot;Deploying new contracts...\&quot;);\n    const MockWETH = await hardhat_1.ethers.getContractFactory(\&quot;MockWETH\&quot;, owner);\n    mockWETH = await MockWETH.deploy();\n    await mockWETH.deployed();\n    addresses.weth = mockWETH.address;\n    const MockUSDC = await hardhat_1.ethers.getContractFactory(\&quot;MockUSDC\&quot;, owner);\n    mockUSDC = await MockUSDC.deploy();\n    await mockUSDC.deployed();\n    addresses.usdc = mockUSDC.address;\n    const LendingProtocol = await hardhat_1.ethers.getContractFactory(\&quot;TestLendingProtocol\&quot;, owner);\n    lendingProtocol = await LendingProtocol.deploy(mockWETH.address);\n    await lendingProtocol.deployed();\n    addresses.lendingProtocol = lendingProtocol.address;\n    console.log(\&quot;Contracts deployed:\&quot;, {\n        weth: addresses.weth,\n        usdc: addresses.usdc,\n        lendingProtocol: addresses.lendingProtocol\n    });\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4c7e1f25-b63b-4479-9a09-f73aaecc547e&quot;,&quot;parentUUID&quot;:&quot;b07994b9-542c-4445-8953-326136585ec2&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;Performance and Concurrency Tests\&quot;&quot;,&quot;fullTitle&quot;:&quot;Performance and Concurrency Tests \&quot;before each\&quot; hook in \&quot;Performance and Concurrency Tests\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:null,&quot;speed&quot;:null,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:null,&quot;code&quot;:&quot;// Connect to contracts\ntry {\n    mockWETH = await hardhat_1.ethers.getContractAt(\&quot;MockWETH\&quot;, addresses.weth, owner);\n    mockUSDC = await hardhat_1.ethers.getContractAt(\&quot;MockUSDC\&quot;, addresses.usdc, owner);\n    lendingProtocol = await hardhat_1.ethers.getContractAt(\&quot;TestLendingProtocol\&quot;, addresses.lendingProtocol, owner);\n}\ncatch (error) {\n    console.error(\&quot;Failed to connect to contracts:\&quot;, error);\n    throw error;\n}\n// @ts-ignore\n(0, addContext_1.default)(this, {\n    title: &#x27;Test Setup&#x27;,\n    value: {\n        contracts: {\n            weth: addresses.weth,\n            usdc: addresses.usdc,\n            lendingProtocol: addresses.lendingProtocol\n        },\n        owner: owner.address,\n        availableUsers: users.length\n    }\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b88b2857-1543-4370-92a9-3a29c4fe3136&quot;,&quot;parentUUID&quot;:&quot;b07994b9-542c-4445-8953-326136585ec2&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook: after gas report&quot;,&quot;fullTitle&quot;:&quot;Performance and Concurrency Tests \&quot;after all\&quot; hook: after gas report&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:null,&quot;speed&quot;:null,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:&quot;[{\&quot;title\&quot;:\&quot;Gas Usage Report\&quot;,\&quot;value\&quot;:{\&quot;blockGasLimit\&quot;:\&quot;35754398 gas\&quot;,\&quot;tokenPrice\&quot;:\&quot;2690.58 usd/eth\&quot;,\&quot;gasPrice\&quot;:\&quot;0.817097097 gwei\&quot;,\&quot;methods\&quot;:{\&quot;borrow\&quot;:{\&quot;calls\&quot;:0},\&quot;deposit\&quot;:{\&quot;avg\&quot;:66755,\&quot;min\&quot;:57039,\&quot;max\&quot;:125439,\&quot;calls\&quot;:44,\&quot;usd\&quot;:\&quot;0.15\&quot;},\&quot;renounceOwnership\&quot;:{\&quot;calls\&quot;:0},\&quot;repay\&quot;:{\&quot;calls\&quot;:0},\&quot;transferOwnership\&quot;:{\&quot;calls\&quot;:0},\&quot;withdraw\&quot;:{\&quot;avg\&quot;:57411,\&quot;min\&quot;:55808,\&quot;max\&quot;:60608,\&quot;calls\&quot;:9,\&quot;usd\&quot;:\&quot;0.13\&quot;}}}}]&quot;,&quot;code&quot;:&quot;try {\n          const gasReport = require(&#x27;./gas-reports/hardhat-gas-report.json&#x27;);\n          addContext(this, {\n            title: &#x27;Gas Usage Report&#x27;,\n            value: gasReport\n          });\n        } catch (error) {\n          console.log(&#x27;Gas report not ready yet, skipping...&#x27;, error);\n        }&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;32c9ca5b-5bcd-4e07-aedc-bb5272d60820&quot;,&quot;parentUUID&quot;:&quot;b07994b9-542c-4445-8953-326136585ec2&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;403cd816-7bcf-4932-8b93-75649f1dad52&quot;,&quot;title&quot;:&quot;Concurrent Operations&quot;,&quot;fullFile&quot;:&quot;/Users/thanasornsawan/E2E_blockchain_testing/test/integration/A_PerformanceTest.test.ts&quot;,&quot;file&quot;:&quot;/test/integration/A_PerformanceTest.test.ts&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should handle deposit and withdraw operations in parallel&quot;,&quot;fullTitle&quot;:&quot;Performance and Concurrency Tests Concurrent Operations should handle deposit and withdraw operations in parallel&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1299,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:&quot;[\n  {\n    \&quot;title\&quot;: \&quot;Test Setup\&quot;,\n    \&quot;value\&quot;: {\n      \&quot;contracts\&quot;: {\n        \&quot;weth\&quot;: \&quot;0xC070A317F23E9A4e982e356485416251dd3Ed944\&quot;,\n        \&quot;usdc\&quot;: \&quot;0x6D39d71fF4ab56a4873febd34e1a3BDefc01b41e\&quot;,\n        \&quot;lendingProtocol\&quot;: \&quot;0xe3EF345391654121f385679613Cea79A692C2Dd8\&quot;\n      },\n      \&quot;owner\&quot;: \&quot;0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266\&quot;,\n      \&quot;availableUsers\&quot;: 4\n    }\n  },\n  {\n    \&quot;title\&quot;: \&quot;Operation Results\&quot;,\n    \&quot;value\&quot;: {\n      \&quot;user\&quot;: \&quot;0x70997970C51812dc3A010C7d01b50e0d17dc79C8\&quot;,\n      \&quot;operations\&quot;: [\n        {\n          \&quot;type\&quot;: \&quot;Initial Deposit\&quot;,\n          \&quot;amount\&quot;: \&quot;2.0\&quot;,\n          \&quot;gasUsed\&quot;: \&quot;125439\&quot;\n        },\n        {\n          \&quot;type\&quot;: \&quot;Withdraw\&quot;,\n          \&quot;amount\&quot;: \&quot;1.0\&quot;,\n          \&quot;gasUsed\&quot;: \&quot;60608\&quot;\n        },\n        {\n          \&quot;type\&quot;: \&quot;Second Deposit\&quot;,\n          \&quot;amount\&quot;: \&quot;0.5\&quot;,\n          \&quot;gasUsed\&quot;: \&quot;57039\&quot;\n        }\n      ],\n      \&quot;finalBalance\&quot;: \&quot;1.5\&quot;\n    }\n  }\n]&quot;,&quot;code&quot;:&quot;const testUser = await setupTestUser(0, \&quot;1000\&quot;);\nconst userContract = lendingProtocol.connect(testUser);\nconst initialDeposit = hardhat_1.ethers.utils.parseEther(\&quot;2\&quot;);\ntry {\n    // Initial deposit\n    const depositTx = await userContract.deposit({ value: initialDeposit });\n    const depositReceipt = await depositTx.wait();\n    // Withdraw operation\n    const withdrawAmount = hardhat_1.ethers.utils.parseEther(\&quot;1\&quot;);\n    const withdrawTx = await userContract.withdraw(withdrawAmount);\n    const withdrawReceipt = await withdrawTx.wait();\n    // Second deposit\n    const secondDepositAmount = hardhat_1.ethers.utils.parseEther(\&quot;0.5\&quot;);\n    const secondDepositTx = await userContract.deposit({ value: secondDepositAmount });\n    const secondDepositReceipt = await secondDepositTx.wait();\n    // Verify final balance\n    const finalBalance = await userContract.getUserDeposit(testUser.address);\n    const expectedBalance = initialDeposit.sub(withdrawAmount).add(secondDepositAmount);\n    (0, chai_1.expect)(finalBalance).to.equal(expectedBalance);\n    // @ts-ignore\n    (0, addContext_1.default)(this, {\n        title: &#x27;Operation Results&#x27;,\n        value: {\n            user: testUser.address,\n            operations: [\n                {\n                    type: &#x27;Initial Deposit&#x27;,\n                    amount: hardhat_1.ethers.utils.formatEther(initialDeposit),\n                    gasUsed: depositReceipt.gasUsed.toString()\n                },\n                {\n                    type: &#x27;Withdraw&#x27;,\n                    amount: hardhat_1.ethers.utils.formatEther(withdrawAmount),\n                    gasUsed: withdrawReceipt.gasUsed.toString()\n                },\n                {\n                    type: &#x27;Second Deposit&#x27;,\n                    amount: hardhat_1.ethers.utils.formatEther(secondDepositAmount),\n                    gasUsed: secondDepositReceipt.gasUsed.toString()\n                }\n            ],\n            finalBalance: hardhat_1.ethers.utils.formatEther(finalBalance)\n        }\n    });\n}\ncatch (error) {\n    console.error(\&quot;Operation failed:\&quot;, error);\n    throw error;\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;86d44652-0af5-48e8-bdad-a1944aa838f3&quot;,&quot;parentUUID&quot;:&quot;403cd816-7bcf-4932-8b93-75649f1dad52&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should maintain consistent performance under sustained load&quot;,&quot;fullTitle&quot;:&quot;Performance and Concurrency Tests Concurrent Operations should maintain consistent performance under sustained load&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:133,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:&quot;[\n  {\n    \&quot;title\&quot;: \&quot;Test Setup\&quot;,\n    \&quot;value\&quot;: {\n      \&quot;contracts\&quot;: {\n        \&quot;weth\&quot;: \&quot;0xC070A317F23E9A4e982e356485416251dd3Ed944\&quot;,\n        \&quot;usdc\&quot;: \&quot;0x6D39d71fF4ab56a4873febd34e1a3BDefc01b41e\&quot;,\n        \&quot;lendingProtocol\&quot;: \&quot;0xe3EF345391654121f385679613Cea79A692C2Dd8\&quot;\n      },\n      \&quot;owner\&quot;: \&quot;0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266\&quot;,\n      \&quot;availableUsers\&quot;: 4\n    }\n  },\n  {\n    \&quot;title\&quot;: \&quot;Load Test Results\&quot;,\n    \&quot;value\&quot;: {\n      \&quot;userAddress\&quot;: \&quot;0x70997970C51812dc3A010C7d01b50e0d17dc79C8\&quot;,\n      \&quot;depositAmount\&quot;: \&quot;0.1\&quot;,\n      \&quot;iterations\&quot;: 3,\n      \&quot;initialBalance\&quot;: \&quot;1.5\&quot;,\n      \&quot;expectedFinalBalance\&quot;: \&quot;1.8\&quot;,\n      \&quot;actualFinalBalance\&quot;: \&quot;1.8\&quot;,\n      \&quot;operations\&quot;: [\n        {\n          \&quot;iteration\&quot;: 1,\n          \&quot;depositAmount\&quot;: \&quot;0.1\&quot;,\n          \&quot;gasUsed\&quot;: \&quot;57039\&quot;,\n          \&quot;executionTime\&quot;: \&quot;28ms\&quot;,\n          \&quot;balanceAfterDeposit\&quot;: \&quot;1.6\&quot;\n        },\n        {\n          \&quot;iteration\&quot;: 2,\n          \&quot;depositAmount\&quot;: \&quot;0.1\&quot;,\n          \&quot;gasUsed\&quot;: \&quot;57039\&quot;,\n          \&quot;executionTime\&quot;: \&quot;72ms\&quot;,\n          \&quot;balanceAfterDeposit\&quot;: \&quot;1.7\&quot;\n        },\n        {\n          \&quot;iteration\&quot;: 3,\n          \&quot;depositAmount\&quot;: \&quot;0.1\&quot;,\n          \&quot;gasUsed\&quot;: \&quot;57039\&quot;,\n          \&quot;executionTime\&quot;: \&quot;22ms\&quot;,\n          \&quot;balanceAfterDeposit\&quot;: \&quot;1.8\&quot;\n        }\n      ],\n      \&quot;performance\&quot;: {\n        \&quot;averageGasUsed\&quot;: 57039,\n        \&quot;averageExecutionTime\&quot;: \&quot;40.666666666666664ms\&quot;\n      }\n    }\n  }\n]&quot;,&quot;code&quot;:&quot;const testUser = await setupTestUser(0, \&quot;1000\&quot;);\nconst userContract = lendingProtocol.connect(testUser);\nconst depositAmount = hardhat_1.ethers.utils.parseEther(\&quot;0.1\&quot;);\nconst iterations = 3;\nconst results = [];\ntry {\n    // Get initial balance\n    const initialBalance = await userContract.getUserDeposit(testUser.address);\n    console.log(\&quot;Initial balance:\&quot;, hardhat_1.ethers.utils.formatEther(initialBalance));\n    let expectedBalance = initialBalance;\n    for (let i = 0; i &lt; iterations; i++) {\n        const startTime = Date.now();\n        const tx = await userContract.deposit({ value: depositAmount });\n        const receipt = await tx.wait();\n        // Update expected balance\n        expectedBalance = expectedBalance.add(depositAmount);\n        // Get actual balance after deposit\n        const currentBalance = await userContract.getUserDeposit(testUser.address);\n        results.push({\n            iteration: i + 1,\n            depositAmount: hardhat_1.ethers.utils.formatEther(depositAmount),\n            gasUsed: receipt.gasUsed.toString(),\n            executionTime: Date.now() - startTime,\n            balanceAfterDeposit: hardhat_1.ethers.utils.formatEther(currentBalance)\n        });\n        // Verify balance after each iteration\n        (0, chai_1.expect)(currentBalance).to.equal(expectedBalance, `Balance mismatch after iteration ${i + 1}`);\n    }\n    const finalBalance = await userContract.getUserDeposit(testUser.address);\n    const totalDeposited = depositAmount.mul(iterations);\n    const expectedFinalBalance = initialBalance.add(totalDeposited);\n    (0, chai_1.expect)(finalBalance).to.equal(expectedFinalBalance, \&quot;Final balance does not match expected total\&quot;);\n    // @ts-ignore\n    (0, addContext_1.default)(this, {\n        title: &#x27;Load Test Results&#x27;,\n        value: {\n            userAddress: testUser.address,\n            depositAmount: hardhat_1.ethers.utils.formatEther(depositAmount),\n            iterations,\n            initialBalance: hardhat_1.ethers.utils.formatEther(initialBalance),\n            expectedFinalBalance: hardhat_1.ethers.utils.formatEther(expectedFinalBalance),\n            actualFinalBalance: hardhat_1.ethers.utils.formatEther(finalBalance),\n            operations: results.map(r =&gt; ({\n                iteration: r.iteration,\n                depositAmount: r.depositAmount,\n                gasUsed: r.gasUsed,\n                executionTime: r.executionTime + \&quot;ms\&quot;,\n                balanceAfterDeposit: r.balanceAfterDeposit\n            })),\n            performance: {\n                averageGasUsed: results.reduce((acc, r) =&gt; acc + parseInt(r.gasUsed), 0) / results.length,\n                averageExecutionTime: results.reduce((acc, r) =&gt; acc + r.executionTime, 0) / results.length + \&quot;ms\&quot;\n            }\n        }\n    });\n}\ncatch (error) {\n    console.error(\&quot;Load test failed:\&quot;, error);\n    // Safely handle the error for reporting\n    const errorMessage = error instanceof Error ? error.message : &#x27;Unknown error&#x27;;\n    const errorDetails = {\n        message: errorMessage,\n        type: error instanceof Error ? error.constructor.name : typeof error,\n        lastKnownState: results.length &gt; 0 ? results[results.length - 1] : null\n    };\n    // @ts-ignore\n    (0, addContext_1.default)(this, {\n        title: &#x27;Load Test Failure Details&#x27;,\n        value: errorDetails\n    });\n    throw error;\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c9f4b245-5115-4e05-b5ee-cf131682c8af&quot;,&quot;parentUUID&quot;:&quot;403cd816-7bcf-4932-8b93-75649f1dad52&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should handle operations with varying data sizes efficiently&quot;,&quot;fullTitle&quot;:&quot;Performance and Concurrency Tests Concurrent Operations should handle operations with varying data sizes efficiently&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:72,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:&quot;[\n  {\n    \&quot;title\&quot;: \&quot;Test Setup\&quot;,\n    \&quot;value\&quot;: {\n      \&quot;contracts\&quot;: {\n        \&quot;weth\&quot;: \&quot;0xC070A317F23E9A4e982e356485416251dd3Ed944\&quot;,\n        \&quot;usdc\&quot;: \&quot;0x6D39d71fF4ab56a4873febd34e1a3BDefc01b41e\&quot;,\n        \&quot;lendingProtocol\&quot;: \&quot;0xe3EF345391654121f385679613Cea79A692C2Dd8\&quot;\n      },\n      \&quot;owner\&quot;: \&quot;0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266\&quot;,\n      \&quot;availableUsers\&quot;: 4\n    }\n  },\n  {\n    \&quot;title\&quot;: \&quot;Size Scaling Results\&quot;,\n    \&quot;value\&quot;: {\n      \&quot;userAddress\&quot;: \&quot;0x70997970C51812dc3A010C7d01b50e0d17dc79C8\&quot;,\n      \&quot;deposits\&quot;: [\n        {\n          \&quot;amount\&quot;: \&quot;0.001\&quot;,\n          \&quot;gasUsed\&quot;: \&quot;57039\&quot;,\n          \&quot;executionTime\&quot;: 18\n        },\n        {\n          \&quot;amount\&quot;: \&quot;0.1\&quot;,\n          \&quot;gasUsed\&quot;: \&quot;57039\&quot;,\n          \&quot;executionTime\&quot;: 21\n        },\n        {\n          \&quot;amount\&quot;: \&quot;1.0\&quot;,\n          \&quot;gasUsed\&quot;: \&quot;57039\&quot;,\n          \&quot;executionTime\&quot;: 18\n        }\n      ],\n      \&quot;totalBalance\&quot;: \&quot;2.901\&quot;\n    }\n  }\n]&quot;,&quot;code&quot;:&quot;const testUser = await setupTestUser(0, \&quot;1000\&quot;);\nconst userContract = lendingProtocol.connect(testUser);\nconst depositSizes = [\n    hardhat_1.ethers.utils.parseEther(\&quot;0.001\&quot;),\n    hardhat_1.ethers.utils.parseEther(\&quot;0.1\&quot;),\n    hardhat_1.ethers.utils.parseEther(\&quot;1\&quot;)\n];\nconst results = [];\ntry {\n    for (const amount of depositSizes) {\n        const startTime = Date.now();\n        const tx = await userContract.deposit({ value: amount });\n        const receipt = await tx.wait();\n        results.push({\n            amount: hardhat_1.ethers.utils.formatEther(amount),\n            gasUsed: receipt.gasUsed.toString(),\n            executionTime: Date.now() - startTime\n        });\n        // Verify deposit\n        const balance = await userContract.getUserDeposit(testUser.address);\n        (0, chai_1.expect)(balance).to.be.gt(0);\n    }\n    // @ts-ignore\n    (0, addContext_1.default)(this, {\n        title: &#x27;Size Scaling Results&#x27;,\n        value: {\n            userAddress: testUser.address,\n            deposits: results,\n            totalBalance: hardhat_1.ethers.utils.formatEther(await userContract.getUserDeposit(testUser.address))\n        }\n    });\n}\ncatch (error) {\n    console.error(\&quot;Size scaling test failed:\&quot;, error);\n    throw error;\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1de9d36d-6d33-45a5-bbe8-1c93af08cefe&quot;,&quot;parentUUID&quot;:&quot;403cd816-7bcf-4932-8b93-75649f1dad52&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;86d44652-0af5-48e8-bdad-a1944aa838f3&quot;,&quot;c9f4b245-5115-4e05-b5ee-cf131682c8af&quot;,&quot;1de9d36d-6d33-45a5-bbe8-1c93af08cefe&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1504,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;82ef18da-c163-465d-bb77-e2a4ce70d202&quot;,&quot;title&quot;:&quot;Cross Network Testing&quot;,&quot;fullFile&quot;:&quot;/Users/thanasornsawan/E2E_blockchain_testing/test/integration/CrossNetworkTest.test.ts&quot;,&quot;file&quot;:&quot;/test/integration/CrossNetworkTest.test.ts&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;Cross Network Testing\&quot;&quot;,&quot;fullTitle&quot;:&quot;Cross Network Testing \&quot;before all\&quot; hook in \&quot;Cross Network Testing\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:null,&quot;speed&quot;:null,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:null,&quot;code&quot;:&quot;// Get all available signers\nconst signers = await hardhat_1.ethers.getSigners();\n//console.log(`Found ${signers.length} signers`);\nif (signers.length === 0) {\n    throw new Error(\&quot;No signers available\&quot;);\n}\nsigner = signers[0];\n//console.log(\&quot;Using signer address:\&quot;, await signer.getAddress());\nnetworkInfo = await hardhat_1.ethers.provider.getNetwork();\nswitch (networkInfo.chainId) {\n    case 1:\n    case 31337:\n        networkName = \&quot;mainnet\&quot;;\n        addresses = networkConfig.mainnet;\n        break;\n    case 137:\n        networkName = \&quot;polygon\&quot;;\n        addresses = networkConfig.polygon;\n        break;\n    default:\n        networkName = \&quot;local\&quot;;\n        addresses = networkConfig.local;\n}\nif (!addresses?.weth || !addresses?.usdc) {\n    throw new Error(`Missing addresses for network ${networkInfo.chainId}. Addresses: ${JSON.stringify(addresses)}`);\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;60cbca34-4398-4c97-97ed-3232c3fda91b&quot;,&quot;parentUUID&quot;:&quot;82ef18da-c163-465d-bb77-e2a4ce70d202&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;Cross Network Testing\&quot;&quot;,&quot;fullTitle&quot;:&quot;Cross Network Testing \&quot;before each\&quot; hook in \&quot;Cross Network Testing\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:18,&quot;state&quot;:null,&quot;speed&quot;:null,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:null,&quot;code&quot;:&quot;try {\n    //console.log(\&quot;Starting beforeEach...\&quot;);\n    [signer] = await hardhat_1.ethers.getSigners(); // Get the first test signer\n    const balanceBefore = await signer.getBalance();\n    console.log(\&quot;Test account balance before funding:\&quot;, hardhat_1.ethers.utils.formatEther(await signer.getBalance()), \&quot;ETH\&quot;);\n    // **Set balance manually using Hardhat Network**\n    await hardhat_1.ethers.provider.send(\&quot;hardhat_setBalance\&quot;, [\n        signer.address,\n        \&quot;0x21E19E0C9BAB2400000\&quot;, // 10,000 ETH in hex (adjust if needed)\n    ]);\n    const balanceAfter = await signer.getBalance();\n    console.log(\&quot;Test account balance after funding:\&quot;, hardhat_1.ethers.utils.formatEther(await signer.getBalance()), \&quot;ETH\&quot;);\n    // Verify contracts exist and are accessible\n    if (!addresses?.weth || !addresses?.usdc) {\n        throw new Error(\&quot;Contract addresses not found. Please run deployment first.\&quot;);\n    }\n    // Initialize WETH\n    weth = await hardhat_1.ethers.getContractAt(\&quot;IWETH\&quot;, addresses.weth, signer);\n    //console.log(\&quot;WETH contract initialized at:\&quot;, addresses.weth);\n    // Initialize USDC\n    usdc = new contracts_1.Contract(addresses.usdc, ERC20_ABI, signer);\n    //console.log(\&quot;USDC contract initialized at:\&quot;, addresses.usdc);\n    // Try to verify contracts are accessible\n    const wethSymbol = await weth.symbol();\n    //console.log(\&quot;WETH symbol:\&quot;, wethSymbol);\n    const usdcSymbol = await usdc.symbol();\n    //console.log(\&quot;USDC symbol:\&quot;, usdcSymbol);\n    if (addresses.lendingProtocol) {\n        try {\n            lendingProtocol = await hardhat_1.ethers.getContractAt(\&quot;TestLendingProtocol\&quot;, addresses.lendingProtocol, signer);\n            //console.log(\&quot;LendingProtocol loaded at:\&quot;, addresses.lendingProtocol);\n        }\n        catch (error) {\n            console.error(\&quot;Failed to load LendingProtocol:\&quot;, error);\n        }\n    }\n    else {\n        console.log(\&quot;No LendingProtocol address provided\&quot;);\n    }\n    (0, addContext_1.default)(this, {\n        title: &#x27;Test Setup&#x27;,\n        value: {\n            network: networkName,\n            chainId: networkInfo.chainId,\n            addresses: {\n                weth: addresses.weth,\n                usdc: addresses.usdc,\n                lendingProtocol: addresses.lendingProtocol || &#x27;Not deployed&#x27;\n            },\n            testAccount: {\n                address: signer.address,\n                balanceBefore: `${hardhat_1.ethers.utils.formatEther(balanceBefore)} ETH`,\n                balanceAfter: `${hardhat_1.ethers.utils.formatEther(balanceAfter)} ETH`\n            }\n        }\n    });\n}\ncatch (error) {\n    console.error(\&quot;Error in beforeEach:\&quot;, error);\n    throw error;\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;77249245-b254-40f1-bee9-9ba5c8879a12&quot;,&quot;parentUUID&quot;:&quot;82ef18da-c163-465d-bb77-e2a4ce70d202&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook: after gas report&quot;,&quot;fullTitle&quot;:&quot;Cross Network Testing \&quot;after all\&quot; hook: after gas report&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:null,&quot;speed&quot;:null,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:&quot;[{\&quot;title\&quot;:\&quot;Gas Usage Report\&quot;,\&quot;value\&quot;:{\&quot;blockGasLimit\&quot;:\&quot;35754398 gas\&quot;,\&quot;tokenPrice\&quot;:\&quot;2690.58 usd/eth\&quot;,\&quot;gasPrice\&quot;:\&quot;0.817097097 gwei\&quot;,\&quot;methods\&quot;:{\&quot;borrow\&quot;:{\&quot;calls\&quot;:0},\&quot;deposit\&quot;:{\&quot;avg\&quot;:66755,\&quot;min\&quot;:57039,\&quot;max\&quot;:125439,\&quot;calls\&quot;:44,\&quot;usd\&quot;:\&quot;0.15\&quot;},\&quot;renounceOwnership\&quot;:{\&quot;calls\&quot;:0},\&quot;repay\&quot;:{\&quot;calls\&quot;:0},\&quot;transferOwnership\&quot;:{\&quot;calls\&quot;:0},\&quot;withdraw\&quot;:{\&quot;avg\&quot;:57411,\&quot;min\&quot;:55808,\&quot;max\&quot;:60608,\&quot;calls\&quot;:9,\&quot;usd\&quot;:\&quot;0.13\&quot;}}}}]&quot;,&quot;code&quot;:&quot;try {\n          const gasReport = require(&#x27;./gas-reports/hardhat-gas-report.json&#x27;);\n          addContext(this, {\n            title: &#x27;Gas Usage Report&#x27;,\n            value: gasReport\n          });\n        } catch (error) {\n          console.log(&#x27;Gas report not ready yet, skipping...&#x27;, error);\n        }&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;606344c0-3b5c-413a-a0ea-1ed2fdd8d480&quot;,&quot;parentUUID&quot;:&quot;82ef18da-c163-465d-bb77-e2a4ce70d202&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;12f1013e-d817-424d-8314-4772b86b1078&quot;,&quot;title&quot;:&quot;Interest Calculation Tests&quot;,&quot;fullFile&quot;:&quot;/Users/thanasornsawan/E2E_blockchain_testing/test/integration/CrossNetworkTest.test.ts&quot;,&quot;file&quot;:&quot;/test/integration/CrossNetworkTest.test.ts&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should calculate interest correctly across different block times&quot;,&quot;fullTitle&quot;:&quot;Cross Network Testing Interest Calculation Tests should calculate interest correctly across different block times&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:441,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:&quot;[\n  {\n    \&quot;title\&quot;: \&quot;Test Setup\&quot;,\n    \&quot;value\&quot;: {\n      \&quot;network\&quot;: \&quot;mainnet\&quot;,\n      \&quot;chainId\&quot;: 31337,\n      \&quot;addresses\&quot;: {\n        \&quot;weth\&quot;: \&quot;0xC070A317F23E9A4e982e356485416251dd3Ed944\&quot;,\n        \&quot;usdc\&quot;: \&quot;0x6D39d71fF4ab56a4873febd34e1a3BDefc01b41e\&quot;,\n        \&quot;lendingProtocol\&quot;: \&quot;0xe3EF345391654121f385679613Cea79A692C2Dd8\&quot;\n      },\n      \&quot;testAccount\&quot;: {\n        \&quot;address\&quot;: \&quot;0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266\&quot;,\n        \&quot;balanceBefore\&quot;: \&quot;9999.993348986808676804 ETH\&quot;,\n        \&quot;balanceAfter\&quot;: \&quot;10000.0 ETH\&quot;\n      }\n    }\n  },\n  {\n    \&quot;title\&quot;: \&quot;Interest Calculation Results\&quot;,\n    \&quot;value\&quot;: [\n      {\n        \&quot;scenario\&quot;: \&quot;Fast blocks\&quot;,\n        \&quot;timeElapsed\&quot;: \&quot;50 seconds\&quot;,\n        \&quot;principal\&quot;: \&quot;100.0 ETH\&quot;,\n        \&quot;expectedInterest\&quot;: \&quot;0.000007927447995941 ETH\&quot;,\n        \&quot;actualInterest\&quot;: \&quot;0.000007927447995941 ETH\&quot;,\n        \&quot;tolerance\&quot;: \&quot;0.000000396372399797 ETH\&quot;\n      },\n      {\n        \&quot;scenario\&quot;: \&quot;Normal blocks\&quot;,\n        \&quot;timeElapsed\&quot;: \&quot;65 seconds\&quot;,\n        \&quot;principal\&quot;: \&quot;100.0 ETH\&quot;,\n        \&quot;expectedInterest\&quot;: \&quot;0.000010305682394723 ETH\&quot;,\n        \&quot;actualInterest\&quot;: \&quot;0.000010305682394723 ETH\&quot;,\n        \&quot;tolerance\&quot;: \&quot;0.000000515284119736 ETH\&quot;\n      },\n      {\n        \&quot;scenario\&quot;: \&quot;Slow blocks\&quot;,\n        \&quot;timeElapsed\&quot;: \&quot;75 seconds\&quot;,\n        \&quot;principal\&quot;: \&quot;100.0 ETH\&quot;,\n        \&quot;expectedInterest\&quot;: \&quot;0.000011891171993911 ETH\&quot;,\n        \&quot;actualInterest\&quot;: \&quot;0.000011891171993911 ETH\&quot;,\n        \&quot;tolerance\&quot;: \&quot;0.000000594558599695 ETH\&quot;\n      }\n    ]\n  }\n]&quot;,&quot;code&quot;:&quot;const depositAmount = hardhat_1.ethers.utils.parseEther(\&quot;100\&quot;);\nconst INTEREST_RATE = 500;\n// Initial deposit\nawait lendingProtocol.deposit({ value: depositAmount });\nconst initialTimestamp = (await hardhat_1.ethers.provider.getBlock(\&quot;latest\&quot;)).timestamp;\n// Test different block time scenarios\nconst scenarios = [\n    { description: \&quot;Fast blocks\&quot;, blockTime: 10, blocks: 5 },\n    { description: \&quot;Normal blocks\&quot;, blockTime: 13, blocks: 5 },\n    { description: \&quot;Slow blocks\&quot;, blockTime: 15, blocks: 5 }\n];\nconst results = [];\nfor (const scenario of scenarios) {\n    const snapshotId = await hardhat_1.ethers.provider.send(\&quot;evm_snapshot\&quot;, []);\n    try {\n        // Simulate time passing\n        for (let i = 0; i &lt; scenario.blocks; i++) {\n            await hardhat_1.ethers.provider.send(\&quot;evm_increaseTime\&quot;, [scenario.blockTime]);\n            await hardhat_1.ethers.provider.send(\&quot;evm_mine\&quot;, []);\n        }\n        const currentBlock = await hardhat_1.ethers.provider.getBlock(\&quot;latest\&quot;);\n        const timeElapsed = currentBlock.timestamp - initialTimestamp;\n        const totalWithInterest = await lendingProtocol.getUserDepositWithInterest(signer.address);\n        const actualInterest = totalWithInterest.sub(depositAmount);\n        const expectedInterest = calculateExpectedInterest(depositAmount, timeElapsed, INTEREST_RATE);\n        // Use larger tolerance due to block timestamp variations\n        const tolerance = expectedInterest.mul(5).div(100); // 5% tolerance\n        // Store results for reporting\n        results.push({\n            scenario: scenario.description,\n            timeElapsed: `${timeElapsed} seconds`,\n            principal: `${hardhat_1.ethers.utils.formatEther(depositAmount)} ETH`,\n            expectedInterest: `${hardhat_1.ethers.utils.formatEther(expectedInterest)} ETH`,\n            actualInterest: `${hardhat_1.ethers.utils.formatEther(actualInterest)} ETH`,\n            tolerance: `${hardhat_1.ethers.utils.formatEther(tolerance)} ETH`\n        });\n        (0, chai_1.expect)(actualInterest).to.be.gte(expectedInterest.sub(tolerance), `Interest too low for ${scenario.description}`);\n        (0, chai_1.expect)(actualInterest).to.be.lte(expectedInterest.add(tolerance), `Interest too high for ${scenario.description}`);\n        // Additional checks\n        (0, chai_1.expect)(totalWithInterest).to.be.gt(depositAmount);\n    }\n    finally {\n        await hardhat_1.ethers.provider.send(\&quot;evm_revert\&quot;, [snapshotId]);\n    }\n}\n// @ts-ignore\n(0, addContext_1.default)(this, {\n    title: &#x27;Interest Calculation Results&#x27;,\n    value: results\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0d5765a8-ddff-4b24-8428-32ab687e4821&quot;,&quot;parentUUID&quot;:&quot;12f1013e-d817-424d-8314-4772b86b1078&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should handle extreme time changes&quot;,&quot;fullTitle&quot;:&quot;Cross Network Testing Interest Calculation Tests should handle extreme time changes&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:29,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:&quot;[\n  {\n    \&quot;title\&quot;: \&quot;Test Setup\&quot;,\n    \&quot;value\&quot;: {\n      \&quot;network\&quot;: \&quot;mainnet\&quot;,\n      \&quot;chainId\&quot;: 31337,\n      \&quot;addresses\&quot;: {\n        \&quot;weth\&quot;: \&quot;0xC070A317F23E9A4e982e356485416251dd3Ed944\&quot;,\n        \&quot;usdc\&quot;: \&quot;0x6D39d71fF4ab56a4873febd34e1a3BDefc01b41e\&quot;,\n        \&quot;lendingProtocol\&quot;: \&quot;0xe3EF345391654121f385679613Cea79A692C2Dd8\&quot;\n      },\n      \&quot;testAccount\&quot;: {\n        \&quot;address\&quot;: \&quot;0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266\&quot;,\n        \&quot;balanceBefore\&quot;: \&quot;9899.999807470036690863 ETH\&quot;,\n        \&quot;balanceAfter\&quot;: \&quot;10000.0 ETH\&quot;\n      }\n    }\n  },\n  {\n    \&quot;title\&quot;: \&quot;Extreme Time Change Results\&quot;,\n    \&quot;value\&quot;: {\n      \&quot;timeframe\&quot;: \&quot;30 days\&quot;,\n      \&quot;depositAmount\&quot;: \&quot;100.0 ETH\&quot;,\n      \&quot;totalWithInterest\&quot;: \&quot;200.821917808219178082 ETH\&quot;,\n      \&quot;interestEarned\&quot;: \&quot;100.821917808219178082 ETH\&quot;\n    }\n  }\n]&quot;,&quot;code&quot;:&quot;const depositAmount = hardhat_1.ethers.utils.parseEther(\&quot;100\&quot;);\nawait lendingProtocol.deposit({ value: depositAmount });\nconst ONE_MONTH = 30 * 24 * 60 * 60;\nawait hardhat_1.ethers.provider.send(\&quot;evm_increaseTime\&quot;, [ONE_MONTH]);\nawait hardhat_1.ethers.provider.send(\&quot;evm_mine\&quot;, []);\nconst totalWithInterest = await lendingProtocol.getUserDepositWithInterest(signer.address);\nconst actualInterest = totalWithInterest.sub(depositAmount);\n// @ts-ignore\n(0, addContext_1.default)(this, {\n    title: &#x27;Extreme Time Change Results&#x27;,\n    value: {\n        timeframe: &#x27;30 days&#x27;,\n        depositAmount: `${hardhat_1.ethers.utils.formatEther(depositAmount)} ETH`,\n        totalWithInterest: `${hardhat_1.ethers.utils.formatEther(totalWithInterest)} ETH`,\n        interestEarned: `${hardhat_1.ethers.utils.formatEther(actualInterest)} ETH`\n    }\n});\n(0, chai_1.expect)(actualInterest).to.be.gt(0, \&quot;No interest accrued\&quot;);\n(0, chai_1.expect)(totalWithInterest).to.be.gt(depositAmount, \&quot;Total should be more than deposit\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;eba055f2-c015-489c-b993-3baa3e1a706f&quot;,&quot;parentUUID&quot;:&quot;12f1013e-d817-424d-8314-4772b86b1078&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should calculate interest correctly during network congestion&quot;,&quot;fullTitle&quot;:&quot;Cross Network Testing Interest Calculation Tests should calculate interest correctly during network congestion&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:23,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:&quot;[\n  {\n    \&quot;title\&quot;: \&quot;Test Setup\&quot;,\n    \&quot;value\&quot;: {\n      \&quot;network\&quot;: \&quot;mainnet\&quot;,\n      \&quot;chainId\&quot;: 31337,\n      \&quot;addresses\&quot;: {\n        \&quot;weth\&quot;: \&quot;0xC070A317F23E9A4e982e356485416251dd3Ed944\&quot;,\n        \&quot;usdc\&quot;: \&quot;0x6D39d71fF4ab56a4873febd34e1a3BDefc01b41e\&quot;,\n        \&quot;lendingProtocol\&quot;: \&quot;0xe3EF345391654121f385679613Cea79A692C2Dd8\&quot;\n      },\n      \&quot;testAccount\&quot;: {\n        \&quot;address\&quot;: \&quot;0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266\&quot;,\n        \&quot;balanceBefore\&quot;: \&quot;9899.999880988438389252 ETH\&quot;,\n        \&quot;balanceAfter\&quot;: \&quot;10000.0 ETH\&quot;\n      }\n    }\n  },\n  {\n    \&quot;title\&quot;: \&quot;Network Congestion Test Results\&quot;,\n    \&quot;value\&quot;: {\n      \&quot;depositAmount\&quot;: \&quot;100.0 ETH\&quot;,\n      \&quot;totalWithInterest\&quot;: \&quot;300.00003900304414003 ETH\&quot;,\n      \&quot;interestEarned\&quot;: \&quot;200.00003900304414003 ETH\&quot;,\n      \&quot;gasPrice\&quot;: \&quot;100 gwei\&quot;,\n      \&quot;blockTimes\&quot;: [\n        \&quot;18 seconds\&quot;,\n        \&quot;16 seconds\&quot;,\n        \&quot;15 seconds\&quot;,\n        \&quot;17 seconds\&quot;,\n        \&quot;16 seconds\&quot;\n      ]\n    }\n  }\n]&quot;,&quot;code&quot;:&quot;const depositAmount = hardhat_1.ethers.utils.parseEther(\&quot;100\&quot;);\nawait lendingProtocol.deposit({ value: depositAmount });\nawait hardhat_1.ethers.provider.send(\&quot;hardhat_setNextBlockBaseFeePerGas\&quot;, [\n    hardhat_1.ethers.utils.hexValue(hardhat_1.ethers.utils.parseUnits(\&quot;100\&quot;, \&quot;gwei\&quot;))\n]);\nconst blockTimes = [];\nfor (let i = 0; i &lt; 5; i++) {\n    const blockTime = Math.floor(Math.random() * 5) + 15;\n    blockTimes.push(blockTime);\n    await hardhat_1.ethers.provider.send(\&quot;evm_increaseTime\&quot;, [blockTime]);\n    await hardhat_1.ethers.provider.send(\&quot;evm_mine\&quot;, []);\n}\nconst totalWithInterest = await lendingProtocol.getUserDepositWithInterest(signer.address);\nconst actualInterest = totalWithInterest.sub(depositAmount);\n// @ts-ignore\n(0, addContext_1.default)(this, {\n    title: &#x27;Network Congestion Test Results&#x27;,\n    value: {\n        depositAmount: `${hardhat_1.ethers.utils.formatEther(depositAmount)} ETH`,\n        totalWithInterest: `${hardhat_1.ethers.utils.formatEther(totalWithInterest)} ETH`,\n        interestEarned: `${hardhat_1.ethers.utils.formatEther(actualInterest)} ETH`,\n        gasPrice: &#x27;100 gwei&#x27;,\n        blockTimes: blockTimes.map(time =&gt; `${time} seconds`)\n    }\n});\n(0, chai_1.expect)(totalWithInterest).to.be.gt(depositAmount, \&quot;Interest should accrue during congestion\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b76f2cd2-074b-4c31-b398-031c45222a66&quot;,&quot;parentUUID&quot;:&quot;12f1013e-d817-424d-8314-4772b86b1078&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0d5765a8-ddff-4b24-8428-32ab687e4821&quot;,&quot;eba055f2-c015-489c-b993-3baa3e1a706f&quot;,&quot;b76f2cd2-074b-4c31-b398-031c45222a66&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:493,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;a8acd41f-e9ee-4db5-897d-fa54e438212d&quot;,&quot;title&quot;:&quot;Network Configuration&quot;,&quot;fullFile&quot;:&quot;/Users/thanasornsawan/E2E_blockchain_testing/test/integration/CrossNetworkTest.test.ts&quot;,&quot;file&quot;:&quot;/test/integration/CrossNetworkTest.test.ts&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should have correct WETH address&quot;,&quot;fullTitle&quot;:&quot;Cross Network Testing Network Configuration should have correct WETH address&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:&quot;{\n  \&quot;title\&quot;: \&quot;Test Setup\&quot;,\n  \&quot;value\&quot;: {\n    \&quot;network\&quot;: \&quot;mainnet\&quot;,\n    \&quot;chainId\&quot;: 31337,\n    \&quot;addresses\&quot;: {\n      \&quot;weth\&quot;: \&quot;0xC070A317F23E9A4e982e356485416251dd3Ed944\&quot;,\n      \&quot;usdc\&quot;: \&quot;0x6D39d71fF4ab56a4873febd34e1a3BDefc01b41e\&quot;,\n      \&quot;lendingProtocol\&quot;: \&quot;0xe3EF345391654121f385679613Cea79A692C2Dd8\&quot;\n    },\n    \&quot;testAccount\&quot;: {\n      \&quot;address\&quot;: \&quot;0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266\&quot;,\n      \&quot;balanceBefore\&quot;: \&quot;9899.9999356684383642 ETH\&quot;,\n      \&quot;balanceAfter\&quot;: \&quot;10000.0 ETH\&quot;\n    }\n  }\n}&quot;,&quot;code&quot;:&quot;const symbol = await weth.symbol();\n(0, chai_1.expect)(symbol).to.equal(\&quot;WETH\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d6a151b3-fe06-48b6-be98-7a47a7e66d25&quot;,&quot;parentUUID&quot;:&quot;a8acd41f-e9ee-4db5-897d-fa54e438212d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should have correct USDC address&quot;,&quot;fullTitle&quot;:&quot;Cross Network Testing Network Configuration should have correct USDC address&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:&quot;{\n  \&quot;title\&quot;: \&quot;Test Setup\&quot;,\n  \&quot;value\&quot;: {\n    \&quot;network\&quot;: \&quot;mainnet\&quot;,\n    \&quot;chainId\&quot;: 31337,\n    \&quot;addresses\&quot;: {\n      \&quot;weth\&quot;: \&quot;0xC070A317F23E9A4e982e356485416251dd3Ed944\&quot;,\n      \&quot;usdc\&quot;: \&quot;0x6D39d71fF4ab56a4873febd34e1a3BDefc01b41e\&quot;,\n      \&quot;lendingProtocol\&quot;: \&quot;0xe3EF345391654121f385679613Cea79A692C2Dd8\&quot;\n    },\n    \&quot;testAccount\&quot;: {\n      \&quot;address\&quot;: \&quot;0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266\&quot;,\n      \&quot;balanceBefore\&quot;: \&quot;10000.0 ETH\&quot;,\n      \&quot;balanceAfter\&quot;: \&quot;10000.0 ETH\&quot;\n    }\n  }\n}&quot;,&quot;code&quot;:&quot;const symbol = await usdc.symbol();\n(0, chai_1.expect)(symbol).to.equal(\&quot;USDC\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;150a18a0-21ea-4de1-9c48-4170f4505f03&quot;,&quot;parentUUID&quot;:&quot;a8acd41f-e9ee-4db5-897d-fa54e438212d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d6a151b3-fe06-48b6-be98-7a47a7e66d25&quot;,&quot;150a18a0-21ea-4de1-9c48-4170f4505f03&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:7,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;84f9248a-c992-46b8-a9cf-70f1d6d0f665&quot;,&quot;title&quot;:&quot;Mainnet Fork Specific Tests&quot;,&quot;fullFile&quot;:&quot;/Users/thanasornsawan/E2E_blockchain_testing/test/integration/CrossNetworkTest.test.ts&quot;,&quot;file&quot;:&quot;/test/integration/CrossNetworkTest.test.ts&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should have correct WETH decimals&quot;,&quot;fullTitle&quot;:&quot;Cross Network Testing Mainnet Fork Specific Tests should have correct WETH decimals&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:&quot;{\n  \&quot;title\&quot;: \&quot;Test Setup\&quot;,\n  \&quot;value\&quot;: {\n    \&quot;network\&quot;: \&quot;mainnet\&quot;,\n    \&quot;chainId\&quot;: 31337,\n    \&quot;addresses\&quot;: {\n      \&quot;weth\&quot;: \&quot;0xC070A317F23E9A4e982e356485416251dd3Ed944\&quot;,\n      \&quot;usdc\&quot;: \&quot;0x6D39d71fF4ab56a4873febd34e1a3BDefc01b41e\&quot;,\n      \&quot;lendingProtocol\&quot;: \&quot;0xe3EF345391654121f385679613Cea79A692C2Dd8\&quot;\n    },\n    \&quot;testAccount\&quot;: {\n      \&quot;address\&quot;: \&quot;0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266\&quot;,\n      \&quot;balanceBefore\&quot;: \&quot;10000.0 ETH\&quot;,\n      \&quot;balanceAfter\&quot;: \&quot;10000.0 ETH\&quot;\n    }\n  }\n}&quot;,&quot;code&quot;:&quot;const decimals = await weth.decimals();\n(0, chai_1.expect)(decimals).to.equal(18);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f5b40865-00bc-461a-ba4d-205a774328a6&quot;,&quot;parentUUID&quot;:&quot;84f9248a-c992-46b8-a9cf-70f1d6d0f665&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should have correct USDC decimals&quot;,&quot;fullTitle&quot;:&quot;Cross Network Testing Mainnet Fork Specific Tests should have correct USDC decimals&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:&quot;{\n  \&quot;title\&quot;: \&quot;Test Setup\&quot;,\n  \&quot;value\&quot;: {\n    \&quot;network\&quot;: \&quot;mainnet\&quot;,\n    \&quot;chainId\&quot;: 31337,\n    \&quot;addresses\&quot;: {\n      \&quot;weth\&quot;: \&quot;0xC070A317F23E9A4e982e356485416251dd3Ed944\&quot;,\n      \&quot;usdc\&quot;: \&quot;0x6D39d71fF4ab56a4873febd34e1a3BDefc01b41e\&quot;,\n      \&quot;lendingProtocol\&quot;: \&quot;0xe3EF345391654121f385679613Cea79A692C2Dd8\&quot;\n    },\n    \&quot;testAccount\&quot;: {\n      \&quot;address\&quot;: \&quot;0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266\&quot;,\n      \&quot;balanceBefore\&quot;: \&quot;10000.0 ETH\&quot;,\n      \&quot;balanceAfter\&quot;: \&quot;10000.0 ETH\&quot;\n    }\n  }\n}&quot;,&quot;code&quot;:&quot;const decimals = await usdc.decimals();\n(0, chai_1.expect)(decimals).to.equal(6);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7e97a451-014e-42a8-b5bc-05b9a4888362&quot;,&quot;parentUUID&quot;:&quot;84f9248a-c992-46b8-a9cf-70f1d6d0f665&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should be able to query WETH balance&quot;,&quot;fullTitle&quot;:&quot;Cross Network Testing Mainnet Fork Specific Tests should be able to query WETH balance&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:&quot;[\n  {\n    \&quot;title\&quot;: \&quot;Test Setup\&quot;,\n    \&quot;value\&quot;: {\n      \&quot;network\&quot;: \&quot;mainnet\&quot;,\n      \&quot;chainId\&quot;: 31337,\n      \&quot;addresses\&quot;: {\n        \&quot;weth\&quot;: \&quot;0xC070A317F23E9A4e982e356485416251dd3Ed944\&quot;,\n        \&quot;usdc\&quot;: \&quot;0x6D39d71fF4ab56a4873febd34e1a3BDefc01b41e\&quot;,\n        \&quot;lendingProtocol\&quot;: \&quot;0xe3EF345391654121f385679613Cea79A692C2Dd8\&quot;\n      },\n      \&quot;testAccount\&quot;: {\n        \&quot;address\&quot;: \&quot;0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266\&quot;,\n        \&quot;balanceBefore\&quot;: \&quot;10000.0 ETH\&quot;,\n        \&quot;balanceAfter\&quot;: \&quot;10000.0 ETH\&quot;\n      }\n    }\n  },\n  {\n    \&quot;title\&quot;: \&quot;WETH balance\&quot;,\n    \&quot;value\&quot;: \&quot;1000000.0\&quot;\n  }\n]&quot;,&quot;code&quot;:&quot;const signerAddress = await signer.getAddress();\n(0, chai_1.expect)(signerAddress).to.not.be.undefined;\nconst balance = await weth.balanceOf(signerAddress);\nconsole.log(\&quot;WETH balance:\&quot;, hardhat_1.ethers.utils.formatEther(balance));\n// @ts-ignore\n(0, addContext_1.default)(this, {\n    title: &#x27;WETH balance&#x27;,\n    value: hardhat_1.ethers.utils.formatEther(balance)\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;afd645cc-2b53-47ee-b42a-247c808cdc72&quot;,&quot;parentUUID&quot;:&quot;84f9248a-c992-46b8-a9cf-70f1d6d0f665&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should be able to query USDC balance&quot;,&quot;fullTitle&quot;:&quot;Cross Network Testing Mainnet Fork Specific Tests should be able to query USDC balance&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:&quot;[\n  {\n    \&quot;title\&quot;: \&quot;Test Setup\&quot;,\n    \&quot;value\&quot;: {\n      \&quot;network\&quot;: \&quot;mainnet\&quot;,\n      \&quot;chainId\&quot;: 31337,\n      \&quot;addresses\&quot;: {\n        \&quot;weth\&quot;: \&quot;0xC070A317F23E9A4e982e356485416251dd3Ed944\&quot;,\n        \&quot;usdc\&quot;: \&quot;0x6D39d71fF4ab56a4873febd34e1a3BDefc01b41e\&quot;,\n        \&quot;lendingProtocol\&quot;: \&quot;0xe3EF345391654121f385679613Cea79A692C2Dd8\&quot;\n      },\n      \&quot;testAccount\&quot;: {\n        \&quot;address\&quot;: \&quot;0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266\&quot;,\n        \&quot;balanceBefore\&quot;: \&quot;10000.0 ETH\&quot;,\n        \&quot;balanceAfter\&quot;: \&quot;10000.0 ETH\&quot;\n      }\n    }\n  },\n  {\n    \&quot;title\&quot;: \&quot;USDC balance\&quot;,\n    \&quot;value\&quot;: \&quot;1000000.0\&quot;\n  }\n]&quot;,&quot;code&quot;:&quot;const signerAddress = await signer.getAddress();\n(0, chai_1.expect)(signerAddress).to.not.be.undefined;\nconst balance = await usdc.balanceOf(signerAddress);\nconsole.log(\&quot;USDC balance:\&quot;, hardhat_1.ethers.utils.formatUnits(balance, 6));\n// @ts-ignore\n(0, addContext_1.default)(this, {\n    title: &#x27;USDC balance&#x27;,\n    value: hardhat_1.ethers.utils.formatUnits(balance, 6)\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bd297813-62df-40bd-b8b9-af1ee6b44302&quot;,&quot;parentUUID&quot;:&quot;84f9248a-c992-46b8-a9cf-70f1d6d0f665&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;f5b40865-00bc-461a-ba4d-205a774328a6&quot;,&quot;7e97a451-014e-42a8-b5bc-05b9a4888362&quot;,&quot;afd645cc-2b53-47ee-b42a-247c808cdc72&quot;,&quot;bd297813-62df-40bd-b8b9-af1ee6b44302&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:15,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;dfaa41d4-4dae-4e4c-bb9c-f2589105d1c0&quot;,&quot;title&quot;:&quot;Network Gas Cost Handling&quot;,&quot;fullFile&quot;:&quot;/Users/thanasornsawan/E2E_blockchain_testing/test/integration/CrossNetworkTest.test.ts&quot;,&quot;file&quot;:&quot;/test/integration/CrossNetworkTest.test.ts&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;Network Gas Cost Handling\&quot;&quot;,&quot;fullTitle&quot;:&quot;Cross Network Testing Network Gas Cost Handling \&quot;before each\&quot; hook in \&quot;Network Gas Cost Handling\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:18,&quot;state&quot;:null,&quot;speed&quot;:null,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:null,&quot;code&quot;:&quot;// Get current network gas price as baseline\nbaseGasPrice = await hardhat_1.ethers.provider.getGasPrice();\n// Skip tests if lending protocol is not available\nif (!lendingProtocol) {\n    this.skip();\n}\n// Try to withdraw any existing deposits\ntry {\n    const existingDeposit = await lendingProtocol.getUserDeposit(signer.address);\n    if (existingDeposit.gt(0)) {\n        await lendingProtocol.withdraw(existingDeposit);\n    }\n}\ncatch (error) {\n    console.log(\&quot;No existing deposits to withdraw\&quot;);\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;afbbd7e3-91ef-4335-80dd-12b658340365&quot;,&quot;parentUUID&quot;:&quot;dfaa41d4-4dae-4e4c-bb9c-f2589105d1c0&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should handle different gas price scenarios&quot;,&quot;fullTitle&quot;:&quot;Cross Network Testing Network Gas Cost Handling should handle different gas price scenarios&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:22,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:&quot;[\n  {\n    \&quot;title\&quot;: \&quot;Test Setup\&quot;,\n    \&quot;value\&quot;: {\n      \&quot;network\&quot;: \&quot;mainnet\&quot;,\n      \&quot;chainId\&quot;: 31337,\n      \&quot;addresses\&quot;: {\n        \&quot;weth\&quot;: \&quot;0xC070A317F23E9A4e982e356485416251dd3Ed944\&quot;,\n        \&quot;usdc\&quot;: \&quot;0x6D39d71fF4ab56a4873febd34e1a3BDefc01b41e\&quot;,\n        \&quot;lendingProtocol\&quot;: \&quot;0xe3EF345391654121f385679613Cea79A692C2Dd8\&quot;\n      },\n      \&quot;testAccount\&quot;: {\n        \&quot;address\&quot;: \&quot;0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266\&quot;,\n        \&quot;balanceBefore\&quot;: \&quot;10000.0 ETH\&quot;,\n        \&quot;balanceAfter\&quot;: \&quot;10000.0 ETH\&quot;\n      }\n    }\n  },\n  {\n    \&quot;title\&quot;: \&quot;Gas Analysis\&quot;,\n    \&quot;value\&quot;: {\n      \&quot;gasPrice\&quot;: \&quot;104.581787112 gwei\&quot;,\n      \&quot;gasUsed\&quot;: \&quot;74139\&quot;,\n      \&quot;totalCost\&quot;: \&quot;0.007753589114696568 ETH\&quot;\n    }\n  }\n]&quot;,&quot;code&quot;:&quot;const depositAmount = hardhat_1.ethers.utils.parseEther(\&quot;1\&quot;);\nconst testGasPrice = baseGasPrice.mul(2); // Test with 2x gas price\n// Set network gas price for simulate busy network conditions\nawait hardhat_1.ethers.provider.send(\&quot;hardhat_setNextBlockBaseFeePerGas\&quot;, [\n    hardhat_1.ethers.utils.hexValue(testGasPrice)\n]);\n// Make a deposit with specific gas settings\nconst tx = await lendingProtocol.deposit({\n    value: depositAmount,\n    gasPrice: testGasPrice,\n});\n// Wait for transaction and get receipt\nconst receipt = await tx.wait();\n// Calculate total gas cost\nconst gasCost = receipt.gasUsed.mul(testGasPrice);\nconsole.log(\&quot;\\nGas Price Analysis:\&quot;);\nconsole.log(`Gas Price: ${hardhat_1.ethers.utils.formatUnits(testGasPrice, \&quot;gwei\&quot;)} gwei`);\nconsole.log(`Gas Used: ${receipt.gasUsed.toString()}`);\nconsole.log(`Total Gas Cost: ${hardhat_1.ethers.utils.formatEther(gasCost)} ETH`);\n// @ts-ignore\n(0, addContext_1.default)(this, {\n    title: &#x27;Gas Analysis&#x27;,\n    value: {\n        gasPrice: `${hardhat_1.ethers.utils.formatUnits(testGasPrice, \&quot;gwei\&quot;)} gwei`,\n        gasUsed: receipt.gasUsed.toString(),\n        totalCost: `${hardhat_1.ethers.utils.formatEther(gasCost)} ETH`\n    }\n});\n// Verify gas usage is within expected range\n(0, chai_1.expect)(receipt.gasUsed).to.be.below(300000, \&quot;Gas usage too high\&quot;);\n// Verify transaction succeeded with exact deposit amount\nconst finalDeposit = await lendingProtocol.getUserDeposit(signer.address);\n(0, chai_1.expect)(finalDeposit).to.equal(depositAmount, \&quot;Deposit amount mismatch\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fa076076-07a3-4a44-976e-7ff34bb1bcb0&quot;,&quot;parentUUID&quot;:&quot;dfaa41d4-4dae-4e4c-bb9c-f2589105d1c0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should handle gas price spikes correctly&quot;,&quot;fullTitle&quot;:&quot;Cross Network Testing Network Gas Cost Handling should handle gas price spikes correctly&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:15,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:&quot;{\n  \&quot;title\&quot;: \&quot;Test Setup\&quot;,\n  \&quot;value\&quot;: {\n    \&quot;network\&quot;: \&quot;mainnet\&quot;,\n    \&quot;chainId\&quot;: 31337,\n    \&quot;addresses\&quot;: {\n      \&quot;weth\&quot;: \&quot;0xC070A317F23E9A4e982e356485416251dd3Ed944\&quot;,\n      \&quot;usdc\&quot;: \&quot;0x6D39d71fF4ab56a4873febd34e1a3BDefc01b41e\&quot;,\n      \&quot;lendingProtocol\&quot;: \&quot;0xe3EF345391654121f385679613Cea79A692C2Dd8\&quot;\n    },\n    \&quot;testAccount\&quot;: {\n      \&quot;address\&quot;: \&quot;0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266\&quot;,\n      \&quot;balanceBefore\&quot;: \&quot;10298.989327533207007512 ETH\&quot;,\n      \&quot;balanceAfter\&quot;: \&quot;10000.0 ETH\&quot;\n    }\n  }\n}&quot;,&quot;code&quot;:&quot;// Simulate a gas price spike\nconst spikedGasPrice = baseGasPrice.mul(10); // 10x normal gas price\nawait hardhat_1.ethers.provider.send(\&quot;hardhat_setNextBlockBaseFeePerGas\&quot;, [\n    hardhat_1.ethers.utils.hexValue(spikedGasPrice)\n]);\n// Try to deposit with a gas price limit\nconst depositAmount = hardhat_1.ethers.utils.parseEther(\&quot;1\&quot;);\nconst maxGasPrice = baseGasPrice.mul(5); // Set max gas price at 5x base\n// This transaction should fail due to high gas price\nlet errorThrown = false;\ntry {\n    await lendingProtocol.deposit({\n        value: depositAmount,\n        maxFeePerGas: maxGasPrice\n    });\n}\ncatch (error) { // Type as any to access error.message\n    errorThrown = true;\n    (0, chai_1.expect)(typeof error.message === &#x27;string&#x27;).to.be.true;\n    (0, chai_1.expect)(error.message.toLowerCase()).to.satisfy((msg) =&gt; msg.includes(&#x27;maxfeepergaspergas&#x27;) ||\n        msg.includes(&#x27;max fee per gas&#x27;) ||\n        msg.includes(&#x27;too low&#x27;));\n}\n(0, chai_1.expect)(errorThrown).to.be.true;\n// Verify no deposit was made\nconst finalDeposit = await lendingProtocol.getUserDeposit(signer.address);\n(0, chai_1.expect)(finalDeposit).to.equal(0);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;92d9959e-4d68-4b8b-9085-b1cf1c15c5eb&quot;,&quot;parentUUID&quot;:&quot;dfaa41d4-4dae-4e4c-bb9c-f2589105d1c0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should estimate gas costs accurately&quot;,&quot;fullTitle&quot;:&quot;Cross Network Testing Network Gas Cost Handling should estimate gas costs accurately&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:&quot;[\n  {\n    \&quot;title\&quot;: \&quot;Test Setup\&quot;,\n    \&quot;value\&quot;: {\n      \&quot;network\&quot;: \&quot;mainnet\&quot;,\n      \&quot;chainId\&quot;: 31337,\n      \&quot;addresses\&quot;: {\n        \&quot;weth\&quot;: \&quot;0xC070A317F23E9A4e982e356485416251dd3Ed944\&quot;,\n        \&quot;usdc\&quot;: \&quot;0x6D39d71fF4ab56a4873febd34e1a3BDefc01b41e\&quot;,\n        \&quot;lendingProtocol\&quot;: \&quot;0xe3EF345391654121f385679613Cea79A692C2Dd8\&quot;\n      },\n      \&quot;testAccount\&quot;: {\n        \&quot;address\&quot;: \&quot;0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266\&quot;,\n        \&quot;balanceBefore\&quot;: \&quot;10000.994833648235881472 ETH\&quot;,\n        \&quot;balanceAfter\&quot;: \&quot;10000.0 ETH\&quot;\n      }\n    }\n  },\n  {\n    \&quot;title\&quot;: \&quot;Gas Estimation Accuracy\&quot;,\n    \&quot;value\&quot;: {\n      \&quot;estimated\&quot;: \&quot;79352\&quot;,\n      \&quot;actual\&quot;: \&quot;74139\&quot;,\n      \&quot;percentageDiff\&quot;: \&quot;6%\&quot;\n    }\n  }\n]&quot;,&quot;code&quot;:&quot;const depositAmount = hardhat_1.ethers.utils.parseEther(\&quot;1\&quot;);\n// Get gas estimate\nconst estimatedGas = await lendingProtocol.estimateGas.deposit({\n    value: depositAmount\n});\n// Perform actual transaction\nconst tx = await lendingProtocol.deposit({\n    value: depositAmount\n});\nconst receipt = await tx.wait();\n// Verify estimate was accurate within 10% margin\nconst difference = receipt.gasUsed.sub(estimatedGas).abs();\nconst percentDiff = difference.mul(100).div(estimatedGas);\nconsole.log(\&quot;\\nGas Estimation Analysis:\&quot;);\nconsole.log(`Estimated Gas: ${estimatedGas}`);\nconsole.log(`Actual Gas Used: ${receipt.gasUsed}`);\nconsole.log(`Difference: ${percentDiff}%`);\n// @ts-ignore\n(0, addContext_1.default)(this, {\n    title: &#x27;Gas Estimation Accuracy&#x27;,\n    value: {\n        estimated: estimatedGas.toString(),\n        actual: receipt.gasUsed.toString(),\n        percentageDiff: `${percentDiff}%`\n    }\n});\n(0, chai_1.expect)(percentDiff).to.be.lte(10, \&quot;Gas estimation off by more than 10%\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9f672644-6ae4-447b-92b5-5a99dc2b3d10&quot;,&quot;parentUUID&quot;:&quot;dfaa41d4-4dae-4e4c-bb9c-f2589105d1c0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should handle EIP-1559 style gas pricing&quot;,&quot;fullTitle&quot;:&quot;Cross Network Testing Network Gas Cost Handling should handle EIP-1559 style gas pricing&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:27,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:&quot;[\n  {\n    \&quot;title\&quot;: \&quot;Test Setup\&quot;,\n    \&quot;value\&quot;: {\n      \&quot;network\&quot;: \&quot;mainnet\&quot;,\n      \&quot;chainId\&quot;: 31337,\n      \&quot;addresses\&quot;: {\n        \&quot;weth\&quot;: \&quot;0xC070A317F23E9A4e982e356485416251dd3Ed944\&quot;,\n        \&quot;usdc\&quot;: \&quot;0x6D39d71fF4ab56a4873febd34e1a3BDefc01b41e\&quot;,\n        \&quot;lendingProtocol\&quot;: \&quot;0xe3EF345391654121f385679613Cea79A692C2Dd8\&quot;\n      },\n      \&quot;testAccount\&quot;: {\n        \&quot;address\&quot;: \&quot;0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266\&quot;,\n        \&quot;balanceBefore\&quot;: \&quot;9998.93129266263417726 ETH\&quot;,\n        \&quot;balanceAfter\&quot;: \&quot;10000.0 ETH\&quot;\n      }\n    }\n  },\n  {\n    \&quot;title\&quot;: \&quot;EIP-1559 Gas Analysis\&quot;,\n    \&quot;value\&quot;: {\n      \&quot;baseFee\&quot;: \&quot;811.591616773 gwei\&quot;,\n      \&quot;maxPriorityFee\&quot;: \&quot;2.0 gwei\&quot;,\n      \&quot;effectiveGasPrice\&quot;: \&quot;711.644643818 gwei\&quot;\n    }\n  }\n]&quot;,&quot;code&quot;:&quot;// Ensure no existing deposits\nconst initialDeposit = await lendingProtocol.getUserDeposit(signer.address);\nif (initialDeposit.gt(0)) {\n    await lendingProtocol.withdraw(initialDeposit);\n}\nconst depositAmount = hardhat_1.ethers.utils.parseEther(\&quot;1\&quot;);\nconst baseFee = baseGasPrice;\nconst maxPriorityFeePerGas = hardhat_1.ethers.utils.parseUnits(\&quot;2\&quot;, \&quot;gwei\&quot;);\nconst maxFeePerGas = baseFee.add(maxPriorityFeePerGas);\nconst tx = await lendingProtocol.deposit({\n    value: depositAmount,\n    maxFeePerGas,\n    maxPriorityFeePerGas\n});\nconst receipt = await tx.wait();\nconsole.log(\&quot;\\nEIP-1559 Gas Analysis:\&quot;);\nconsole.log(`Base Fee: ${hardhat_1.ethers.utils.formatUnits(baseFee, \&quot;gwei\&quot;)} gwei`);\nconsole.log(`Max Priority Fee: ${hardhat_1.ethers.utils.formatUnits(maxPriorityFeePerGas, \&quot;gwei\&quot;)} gwei`);\nconsole.log(`Effective Gas Price: ${hardhat_1.ethers.utils.formatUnits(receipt.effectiveGasPrice, \&quot;gwei\&quot;)} gwei`);\n// @ts-ignore\n(0, addContext_1.default)(this, {\n    title: &#x27;EIP-1559 Gas Analysis&#x27;,\n    value: {\n        baseFee: `${hardhat_1.ethers.utils.formatUnits(baseFee, \&quot;gwei\&quot;)} gwei`,\n        maxPriorityFee: `${hardhat_1.ethers.utils.formatUnits(maxPriorityFeePerGas, \&quot;gwei\&quot;)} gwei`,\n        effectiveGasPrice: `${hardhat_1.ethers.utils.formatUnits(receipt.effectiveGasPrice, \&quot;gwei\&quot;)} gwei`\n    }\n});\n// Get final deposit amount and verify it matches\nconst finalDeposit = await lendingProtocol.getUserDeposit(signer.address);\n(0, chai_1.expect)(finalDeposit).to.equal(depositAmount, \&quot;Deposit amount mismatch\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8464f338-41e1-4b10-8c80-101ed75d6f7d&quot;,&quot;parentUUID&quot;:&quot;dfaa41d4-4dae-4e4c-bb9c-f2589105d1c0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;fa076076-07a3-4a44-976e-7ff34bb1bcb0&quot;,&quot;92d9959e-4d68-4b8b-9085-b1cf1c15c5eb&quot;,&quot;9f672644-6ae4-447b-92b5-5a99dc2b3d10&quot;,&quot;8464f338-41e1-4b10-8c80-101ed75d6f7d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:85,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;bc34157d-dfb4-4893-bcb4-0a3f999e7c44&quot;,&quot;title&quot;:&quot;Network-Specific Features&quot;,&quot;fullFile&quot;:&quot;/Users/thanasornsawan/E2E_blockchain_testing/test/integration/CrossNetworkTest.test.ts&quot;,&quot;file&quot;:&quot;/test/integration/CrossNetworkTest.test.ts&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;Network-Specific Features\&quot;&quot;,&quot;fullTitle&quot;:&quot;Cross Network Testing Network-Specific Features \&quot;before each\&quot; hook in \&quot;Network-Specific Features\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:null,&quot;speed&quot;:null,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:null,&quot;code&quot;:&quot;if (!lendingProtocol) {\n    this.skip();\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;30b9a735-efb3-41ab-95ce-0da39c6a5271&quot;,&quot;parentUUID&quot;:&quot;bc34157d-dfb4-4893-bcb4-0a3f999e7c44&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should respect network-specific block times&quot;,&quot;fullTitle&quot;:&quot;Cross Network Testing Network-Specific Features should respect network-specific block times&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:&quot;{\n  \&quot;title\&quot;: \&quot;Test Setup\&quot;,\n  \&quot;value\&quot;: {\n    \&quot;network\&quot;: \&quot;mainnet\&quot;,\n    \&quot;chainId\&quot;: 31337,\n    \&quot;addresses\&quot;: {\n      \&quot;weth\&quot;: \&quot;0xC070A317F23E9A4e982e356485416251dd3Ed944\&quot;,\n      \&quot;usdc\&quot;: \&quot;0x6D39d71fF4ab56a4873febd34e1a3BDefc01b41e\&quot;,\n      \&quot;lendingProtocol\&quot;: \&quot;0xe3EF345391654121f385679613Cea79A692C2Dd8\&quot;\n    },\n    \&quot;testAccount\&quot;: {\n      \&quot;address\&quot;: \&quot;0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266\&quot;,\n      \&quot;balanceBefore\&quot;: \&quot;9999.901946072803109714 ETH\&quot;,\n      \&quot;balanceAfter\&quot;: \&quot;10000.0 ETH\&quot;\n    }\n  }\n}&quot;,&quot;code&quot;:&quot;const startBlock = await hardhat_1.ethers.provider.getBlock(\&quot;latest\&quot;);\n// Mine blocks with appropriate time intervals\nfor (let i = 0; i &lt; 3; i++) {\n    // Increase time by network-specific block time\n    await hardhat_1.ethers.provider.send(\&quot;evm_increaseTime\&quot;, [13]); // 13 seconds for mainnet\n    await hardhat_1.ethers.provider.send(\&quot;evm_mine\&quot;, []);\n}\nconst endBlock = await hardhat_1.ethers.provider.getBlock(\&quot;latest\&quot;);\nconst blockTimeDiff = endBlock.timestamp - startBlock.timestamp;\nconst numberOfBlocks = endBlock.number - startBlock.number;\nconst averageBlockTime = blockTimeDiff / numberOfBlocks;\n// Verify block time matches network expectations\n(0, chai_1.expect)(averageBlockTime).to.be.within(12, 15, \&quot;Block time outside mainnet range\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;84fb59a5-fef9-4642-af38-c832163c3648&quot;,&quot;parentUUID&quot;:&quot;bc34157d-dfb4-4893-bcb4-0a3f999e7c44&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;84fb59a5-fef9-4642-af38-c832163c3648&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;44c08991-09fe-46df-b978-7f95e98804fb&quot;,&quot;title&quot;:&quot;Error Handling Across Networks&quot;,&quot;fullFile&quot;:&quot;/Users/thanasornsawan/E2E_blockchain_testing/test/integration/CrossNetworkTest.test.ts&quot;,&quot;file&quot;:&quot;/test/integration/CrossNetworkTest.test.ts&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;Error Handling Across Networks\&quot;&quot;,&quot;fullTitle&quot;:&quot;Cross Network Testing Error Handling Across Networks \&quot;before each\&quot; hook in \&quot;Error Handling Across Networks\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:null,&quot;speed&quot;:null,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:null,&quot;code&quot;:&quot;if (!lendingProtocol) {\n    this.skip();\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a817dcc9-5726-4722-a1d6-19c09952b2ef&quot;,&quot;parentUUID&quot;:&quot;44c08991-09fe-46df-b978-7f95e98804fb&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should handle insufficient balance errors consistently&quot;,&quot;fullTitle&quot;:&quot;Cross Network Testing Error Handling Across Networks should handle insufficient balance errors consistently&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:&quot;{\n  \&quot;title\&quot;: \&quot;Test Setup\&quot;,\n  \&quot;value\&quot;: {\n    \&quot;network\&quot;: \&quot;mainnet\&quot;,\n    \&quot;chainId\&quot;: 31337,\n    \&quot;addresses\&quot;: {\n      \&quot;weth\&quot;: \&quot;0xC070A317F23E9A4e982e356485416251dd3Ed944\&quot;,\n      \&quot;usdc\&quot;: \&quot;0x6D39d71fF4ab56a4873febd34e1a3BDefc01b41e\&quot;,\n      \&quot;lendingProtocol\&quot;: \&quot;0xe3EF345391654121f385679613Cea79A692C2Dd8\&quot;\n    },\n    \&quot;testAccount\&quot;: {\n      \&quot;address\&quot;: \&quot;0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266\&quot;,\n      \&quot;balanceBefore\&quot;: \&quot;10000.0 ETH\&quot;,\n      \&quot;balanceAfter\&quot;: \&quot;10000.0 ETH\&quot;\n    }\n  }\n}&quot;,&quot;code&quot;:&quot;const depositAmount = hardhat_1.ethers.utils.parseEther(\&quot;10001\&quot;); // More than our 10000 ETH balance\nawait (0, chai_1.expect)(lendingProtocol.deposit({ value: depositAmount })).to.be.revertedWith(\&quot;Insufficient balance\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e08dbd5f-71f6-4194-bf30-6966100703a2&quot;,&quot;parentUUID&quot;:&quot;44c08991-09fe-46df-b978-7f95e98804fb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should handle decimal precision errors consistently&quot;,&quot;fullTitle&quot;:&quot;Cross Network Testing Error Handling Across Networks should handle decimal precision errors consistently&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:&quot;{\n  \&quot;title\&quot;: \&quot;Test Setup\&quot;,\n  \&quot;value\&quot;: {\n    \&quot;network\&quot;: \&quot;mainnet\&quot;,\n    \&quot;chainId\&quot;: 31337,\n    \&quot;addresses\&quot;: {\n      \&quot;weth\&quot;: \&quot;0xC070A317F23E9A4e982e356485416251dd3Ed944\&quot;,\n      \&quot;usdc\&quot;: \&quot;0x6D39d71fF4ab56a4873febd34e1a3BDefc01b41e\&quot;,\n      \&quot;lendingProtocol\&quot;: \&quot;0xe3EF345391654121f385679613Cea79A692C2Dd8\&quot;\n    },\n    \&quot;testAccount\&quot;: {\n      \&quot;address\&quot;: \&quot;0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266\&quot;,\n      \&quot;balanceBefore\&quot;: \&quot;10000.0 ETH\&quot;,\n      \&quot;balanceAfter\&quot;: \&quot;10000.0 ETH\&quot;\n    }\n  }\n}&quot;,&quot;code&quot;:&quot;const tinyAmount = 1; // 1 wei\nawait (0, chai_1.expect)(lendingProtocol.deposit({ value: tinyAmount })).to.not.be.reverted;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a373cf01-6bf0-4344-b0e9-95f804142d59&quot;,&quot;parentUUID&quot;:&quot;44c08991-09fe-46df-b978-7f95e98804fb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e08dbd5f-71f6-4194-bf30-6966100703a2&quot;,&quot;a373cf01-6bf0-4344-b0e9-95f804142d59&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:26,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;86d2c182-f280-4a52-ab06-d87d61063295&quot;,&quot;title&quot;:&quot;Network Specific Limits&quot;,&quot;fullFile&quot;:&quot;/Users/thanasornsawan/E2E_blockchain_testing/test/integration/CrossNetworkTest.test.ts&quot;,&quot;file&quot;:&quot;/test/integration/CrossNetworkTest.test.ts&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should respect network-specific transaction size limits&quot;,&quot;fullTitle&quot;:&quot;Cross Network Testing Network Specific Limits should respect network-specific transaction size limits&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:&quot;[\n  {\n    \&quot;title\&quot;: \&quot;Test Setup\&quot;,\n    \&quot;value\&quot;: {\n      \&quot;network\&quot;: \&quot;mainnet\&quot;,\n      \&quot;chainId\&quot;: 31337,\n      \&quot;addresses\&quot;: {\n        \&quot;weth\&quot;: \&quot;0xC070A317F23E9A4e982e356485416251dd3Ed944\&quot;,\n        \&quot;usdc\&quot;: \&quot;0x6D39d71fF4ab56a4873febd34e1a3BDefc01b41e\&quot;,\n        \&quot;lendingProtocol\&quot;: \&quot;0xe3EF345391654121f385679613Cea79A692C2Dd8\&quot;\n      },\n      \&quot;testAccount\&quot;: {\n        \&quot;address\&quot;: \&quot;0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266\&quot;,\n        \&quot;balanceBefore\&quot;: \&quot;9999.976199086663250457 ETH\&quot;,\n        \&quot;balanceAfter\&quot;: \&quot;10000.0 ETH\&quot;\n      }\n    }\n  },\n  {\n    \&quot;title\&quot;: \&quot;Network Block Limits\&quot;,\n    \&quot;value\&quot;: {\n      \&quot;network\&quot;: \&quot;mainnet\&quot;,\n      \&quot;blockGasLimit\&quot;: \&quot;30000000\&quot;,\n      \&quot;singleTxGas\&quot;: \&quot;62386\&quot;,\n      \&quot;blockGasUsed\&quot;: \&quot;57039\&quot;,\n      \&quot;blockFullness\&quot;: \&quot;0%\&quot;\n    }\n  }\n]&quot;,&quot;code&quot;:&quot;const blockLimit = await hardhat_1.ethers.provider.getBlock(\&quot;latest\&quot;).then(b =&gt; b.gasLimit);\n// Test basic protocol operation gas limits\nconst singleTxGas = await lendingProtocol.estimateGas.deposit({\n    value: hardhat_1.ethers.utils.parseEther(\&quot;1\&quot;)\n});\n// Current block shouldn&#x27;t be near full\nconst block = await hardhat_1.ethers.provider.getBlock(\&quot;latest\&quot;);\nconst blockGasUsed = block.gasUsed;\nconst blockFullnessPercent = blockGasUsed.mul(100).div(blockLimit);\n(0, chai_1.expect)(blockFullnessPercent).to.be.below(95, \&quot;Block too full\&quot;);\n(0, chai_1.expect)(singleTxGas).to.be.below(blockLimit, \&quot;Single tx exceeds block limit\&quot;);\nconsole.log({\n    networkName,\n    blockLimit: blockLimit.toString(),\n    blockGasUsed: blockGasUsed.toString(),\n    blockFullnessPercent: blockFullnessPercent.toString() + &#x27;%&#x27;\n});\n// @ts-ignore\n(0, addContext_1.default)(this, {\n    title: &#x27;Network Block Limits&#x27;,\n    value: {\n        network: networkName,\n        blockGasLimit: blockLimit.toString(),\n        singleTxGas: singleTxGas.toString(),\n        blockGasUsed: blockGasUsed.toString(),\n        blockFullness: blockFullnessPercent.toString() + &#x27;%&#x27;\n    }\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d11b6d2e-7918-42ad-9150-85af0cfec250&quot;,&quot;parentUUID&quot;:&quot;86d2c182-f280-4a52-ab06-d87d61063295&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d11b6d2e-7918-42ad-9150-85af0cfec250&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;61e6a775-2960-4801-8bf4-210a1fc2e25d&quot;,&quot;title&quot;:&quot;Chain Reorganization&quot;,&quot;fullFile&quot;:&quot;/Users/thanasornsawan/E2E_blockchain_testing/test/integration/CrossNetworkTest.test.ts&quot;,&quot;file&quot;:&quot;/test/integration/CrossNetworkTest.test.ts&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should handle state resets correctly&quot;,&quot;fullTitle&quot;:&quot;Cross Network Testing Chain Reorganization should handle state resets correctly&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2357,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:&quot;[\n  {\n    \&quot;title\&quot;: \&quot;Test Setup\&quot;,\n    \&quot;value\&quot;: {\n      \&quot;network\&quot;: \&quot;mainnet\&quot;,\n      \&quot;chainId\&quot;: 31337,\n      \&quot;addresses\&quot;: {\n        \&quot;weth\&quot;: \&quot;0xC070A317F23E9A4e982e356485416251dd3Ed944\&quot;,\n        \&quot;usdc\&quot;: \&quot;0x6D39d71fF4ab56a4873febd34e1a3BDefc01b41e\&quot;,\n        \&quot;lendingProtocol\&quot;: \&quot;0xe3EF345391654121f385679613Cea79A692C2Dd8\&quot;\n      },\n      \&quot;testAccount\&quot;: {\n        \&quot;address\&quot;: \&quot;0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266\&quot;,\n        \&quot;balanceBefore\&quot;: \&quot;10000.0 ETH\&quot;,\n        \&quot;balanceAfter\&quot;: \&quot;10000.0 ETH\&quot;\n      }\n    }\n  },\n  {\n    \&quot;title\&quot;: \&quot;Chain Reorg Test\&quot;,\n    \&quot;value\&quot;: \&quot;Simulating chain reorganization through state reset\&quot;\n  }\n]&quot;,&quot;code&quot;:&quot;(0, addContext_1.default)(this, {\n    title: &#x27;Chain Reorg Test&#x27;,\n    value: &#x27;Simulating chain reorganization through state reset&#x27;\n});\n// Make initial deposit\nconst depositAmount = hardhat_1.ethers.utils.parseEther(\&quot;1\&quot;);\n// Get initial state\nconst initialBalance = await lendingProtocol.getUserDeposit(signer.address);\n// Make deposit\nawait lendingProtocol.deposit({ value: depositAmount });\n// Verify deposit\nconst afterDepositBalance = await lendingProtocol.getUserDeposit(signer.address);\n(0, chai_1.expect)(afterDepositBalance.sub(initialBalance)).to.equal(depositAmount);\n// Reset fork and ensure contract reverts\nawait (0, network_helpers_1.resetFork)();\nawait (0, chai_1.expect)(lendingProtocol.getUserDeposit(signer.address)).to.be.reverted;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;557ea9bd-d69c-49ed-b0c9-f4cd64537271&quot;,&quot;parentUUID&quot;:&quot;61e6a775-2960-4801-8bf4-210a1fc2e25d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;557ea9bd-d69c-49ed-b0c9-f4cd64537271&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2357,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;244d596d-2ee8-49e9-a871-eb4cb0025c6e&quot;,&quot;title&quot;:&quot;Network Conditions Testing&quot;,&quot;fullFile&quot;:&quot;/Users/thanasornsawan/E2E_blockchain_testing/test/integration/NetworkConditionsTest.test.ts&quot;,&quot;file&quot;:&quot;/test/integration/NetworkConditionsTest.test.ts&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;Network Conditions Testing\&quot;&quot;,&quot;fullTitle&quot;:&quot;Network Conditions Testing \&quot;before all\&quot; hook in \&quot;Network Conditions Testing\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:null,&quot;speed&quot;:null,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:null,&quot;code&quot;:&quot;networkInfo = await hardhat_1.ethers.provider.getNetwork();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;aba6ebd2-9c90-4be6-9e34-46c171f240c1&quot;,&quot;parentUUID&quot;:&quot;244d596d-2ee8-49e9-a871-eb4cb0025c6e&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook: after gas report&quot;,&quot;fullTitle&quot;:&quot;Network Conditions Testing \&quot;after all\&quot; hook: after gas report&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:null,&quot;speed&quot;:null,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:&quot;[{\&quot;title\&quot;:\&quot;Gas Usage Report\&quot;,\&quot;value\&quot;:{\&quot;blockGasLimit\&quot;:\&quot;35754398 gas\&quot;,\&quot;tokenPrice\&quot;:\&quot;2690.58 usd/eth\&quot;,\&quot;gasPrice\&quot;:\&quot;0.817097097 gwei\&quot;,\&quot;methods\&quot;:{\&quot;borrow\&quot;:{\&quot;calls\&quot;:0},\&quot;deposit\&quot;:{\&quot;avg\&quot;:66755,\&quot;min\&quot;:57039,\&quot;max\&quot;:125439,\&quot;calls\&quot;:44,\&quot;usd\&quot;:\&quot;0.15\&quot;},\&quot;renounceOwnership\&quot;:{\&quot;calls\&quot;:0},\&quot;repay\&quot;:{\&quot;calls\&quot;:0},\&quot;transferOwnership\&quot;:{\&quot;calls\&quot;:0},\&quot;withdraw\&quot;:{\&quot;avg\&quot;:57411,\&quot;min\&quot;:55808,\&quot;max\&quot;:60608,\&quot;calls\&quot;:9,\&quot;usd\&quot;:\&quot;0.13\&quot;}}}}]&quot;,&quot;code&quot;:&quot;try {\n          const gasReport = require(&#x27;./gas-reports/hardhat-gas-report.json&#x27;);\n          addContext(this, {\n            title: &#x27;Gas Usage Report&#x27;,\n            value: gasReport\n          });\n        } catch (error) {\n          console.log(&#x27;Gas report not ready yet, skipping...&#x27;, error);\n        }&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;78e255ca-d5d6-41a9-a0fc-3d7898c79475&quot;,&quot;parentUUID&quot;:&quot;244d596d-2ee8-49e9-a871-eb4cb0025c6e&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;9a6914b2-486c-478b-a120-a50a2d76d73a&quot;,&quot;title&quot;:&quot;Network Partitioning&quot;,&quot;fullFile&quot;:&quot;/Users/thanasornsawan/E2E_blockchain_testing/test/integration/NetworkConditionsTest.test.ts&quot;,&quot;file&quot;:&quot;/test/integration/NetworkConditionsTest.test.ts&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should recover from temporary network partition&quot;,&quot;fullTitle&quot;:&quot;Network Conditions Testing Network Partitioning should recover from temporary network partition&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:&quot;[\n  {\n    \&quot;title\&quot;: \&quot;Network Partition Test\&quot;,\n    \&quot;value\&quot;: \&quot;Simulating network partition and recovery\&quot;\n  },\n  {\n    \&quot;title\&quot;: \&quot;Block Numbers\&quot;,\n    \&quot;value\&quot;: {\n      \&quot;initialBlock\&quot;: 21818129,\n      \&quot;afterPartitionBlock\&quot;: 21818134,\n      \&quot;blocksMined\&quot;: 5\n    }\n  }\n]&quot;,&quot;code&quot;:&quot;(0, addContext_1.default)(this, {\n    title: &#x27;Network Partition Test&#x27;,\n    value: &#x27;Simulating network partition and recovery&#x27;\n});\nconst initialBlock = await hardhat_1.ethers.provider.getBlockNumber();\nconsole.log(\&quot;Initial block:\&quot;, initialBlock);\nawait (0, network_helpers_1.mineBlocks)(5);\nconst afterPartitionBlock = await hardhat_1.ethers.provider.getBlockNumber();\nconsole.log(\&quot;Block after partition:\&quot;, afterPartitionBlock);\n(0, addContext_1.default)(this, {\n    title: &#x27;Block Numbers&#x27;,\n    value: {\n        initialBlock,\n        afterPartitionBlock,\n        blocksMined: afterPartitionBlock - initialBlock\n    }\n});\n(0, chai_1.expect)(afterPartitionBlock).to.be.gt(initialBlock);\n(0, chai_1.expect)(afterPartitionBlock - initialBlock).to.equal(5);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3631722d-9a55-4ae8-ad80-b1f55b6e7971&quot;,&quot;parentUUID&quot;:&quot;9a6914b2-486c-478b-a120-a50a2d76d73a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3631722d-9a55-4ae8-ad80-b1f55b6e7971&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:8,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;49cb17df-4b74-4499-b599-8365787bf101&quot;,&quot;title&quot;:&quot;Block Time Tests&quot;,&quot;fullFile&quot;:&quot;/Users/thanasornsawan/E2E_blockchain_testing/test/integration/NetworkConditionsTest.test.ts&quot;,&quot;file&quot;:&quot;/test/integration/NetworkConditionsTest.test.ts&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should handle time advancement&quot;,&quot;fullTitle&quot;:&quot;Network Conditions Testing Block Time Tests should handle time advancement&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:&quot;{\n  \&quot;title\&quot;: \&quot;Block Time Test\&quot;,\n  \&quot;value\&quot;: \&quot;Testing block time manipulation\&quot;\n}&quot;,&quot;code&quot;:&quot;(0, addContext_1.default)(this, {\n    title: &#x27;Block Time Test&#x27;,\n    value: &#x27;Testing block time manipulation&#x27;\n});\nconst initialBlock = await hardhat_1.ethers.provider.getBlock(\&quot;latest\&quot;);\nconsole.log(\&quot;Initial timestamp:\&quot;, initialBlock.timestamp);\nawait (0, network_helpers_1.increaseTime)(60); // Advance 60 seconds\nawait hardhat_1.ethers.provider.send(\&quot;evm_mine\&quot;, []);\nconst newBlock = await hardhat_1.ethers.provider.getBlock(\&quot;latest\&quot;);\nconsole.log(\&quot;New timestamp:\&quot;, newBlock.timestamp);\n(0, chai_1.expect)(newBlock.timestamp).to.be.gt(initialBlock.timestamp);\n(0, chai_1.expect)(newBlock.timestamp - initialBlock.timestamp).to.be.gte(60);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a0868e3d-5c0d-450a-926f-b152271df184&quot;,&quot;parentUUID&quot;:&quot;49cb17df-4b74-4499-b599-8365787bf101&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a0868e3d-5c0d-450a-926f-b152271df184&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:8,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;99926e8b-0cec-4177-966a-bdc199ec9be3&quot;,&quot;title&quot;:&quot;Network Metrics&quot;,&quot;fullFile&quot;:&quot;/Users/thanasornsawan/E2E_blockchain_testing/test/integration/NetworkConditionsTest.test.ts&quot;,&quot;file&quot;:&quot;/test/integration/NetworkConditionsTest.test.ts&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should report network statistics&quot;,&quot;fullTitle&quot;:&quot;Network Conditions Testing Network Metrics should report network statistics&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:&quot;{\n  \&quot;title\&quot;: \&quot;Network Metrics\&quot;,\n  \&quot;value\&quot;: {\n    \&quot;network\&quot;: \&quot;unknown\&quot;,\n    \&quot;chainId\&quot;: 31337,\n    \&quot;blockGasLimit\&quot;: \&quot;30000000\&quot;,\n    \&quot;currentGasPrice\&quot;: \&quot;1.357856947 gwei\&quot;,\n    \&quot;currentBlockNumber\&quot;: 21818136\n  }\n}&quot;,&quot;code&quot;:&quot;const blockLimit = await hardhat_1.ethers.provider.getBlock(\&quot;latest\&quot;).then(b =&gt; b.gasLimit);\nconst gasPrice = await hardhat_1.ethers.provider.getGasPrice();\nconst blockNumber = await hardhat_1.ethers.provider.getBlockNumber();\n(0, addContext_1.default)(this, {\n    title: &#x27;Network Metrics&#x27;,\n    value: {\n        network: networkInfo.name,\n        chainId: networkInfo.chainId,\n        blockGasLimit: blockLimit.toString(),\n        currentGasPrice: hardhat_1.ethers.utils.formatUnits(gasPrice, \&quot;gwei\&quot;) + \&quot; gwei\&quot;,\n        currentBlockNumber: blockNumber\n    }\n});\n(0, chai_1.expect)(blockLimit).to.be.gt(0);\n(0, chai_1.expect)(gasPrice).to.be.gt(0);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f0e1bff3-7ad2-4477-93b2-fb3ee428b750&quot;,&quot;parentUUID&quot;:&quot;99926e8b-0cec-4177-966a-bdc199ec9be3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;f0e1bff3-7ad2-4477-93b2-fb3ee428b750&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;6445c7cb-9c8d-48ee-86bb-194423aeef78&quot;,&quot;title&quot;:&quot;Node Failure Testing&quot;,&quot;fullFile&quot;:&quot;/Users/thanasornsawan/E2E_blockchain_testing/test/integration/NetworkConditionsTest.test.ts&quot;,&quot;file&quot;:&quot;/test/integration/NetworkConditionsTest.test.ts&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should handle node restart&quot;,&quot;fullTitle&quot;:&quot;Network Conditions Testing Node Failure Testing should handle node restart&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1671,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:&quot;[\n  {\n    \&quot;title\&quot;: \&quot;Node Failure Test\&quot;,\n    \&quot;value\&quot;: \&quot;Testing node restart behavior\&quot;\n  },\n  {\n    \&quot;title\&quot;: \&quot;Node Recovery\&quot;,\n    \&quot;value\&quot;: {\n      \&quot;initialBlock\&quot;: 21818136,\n      \&quot;newBlock\&quot;: 21818136,\n      \&quot;initialGasPrice\&quot;: \&quot;1.357856947 gwei\&quot;,\n      \&quot;newGasPrice\&quot;: \&quot;2.121004691 gwei\&quot;\n    }\n  }\n]&quot;,&quot;code&quot;:&quot;(0, addContext_1.default)(this, {\n    title: &#x27;Node Failure Test&#x27;,\n    value: &#x27;Testing node restart behavior&#x27;\n});\n// Get initial block and network state\nconst initialBlock = await hardhat_1.ethers.provider.getBlockNumber();\nconst initialGasPrice = await hardhat_1.ethers.provider.getGasPrice();\n// Reset node\nawait hardhat_1.ethers.provider.send(\&quot;hardhat_reset\&quot;, [{\n        forking: {\n            jsonRpcUrl: process.env.MAINNET_RPC_URL,\n            blockNumber: await hardhat_1.ethers.provider.getBlockNumber()\n        }\n    }]);\n// Verify network is still operational\nconst newBlock = await hardhat_1.ethers.provider.getBlockNumber();\nconst newGasPrice = await hardhat_1.ethers.provider.getGasPrice();\n(0, addContext_1.default)(this, {\n    title: &#x27;Node Recovery&#x27;,\n    value: {\n        initialBlock,\n        newBlock,\n        initialGasPrice: hardhat_1.ethers.utils.formatUnits(initialGasPrice, \&quot;gwei\&quot;) + \&quot; gwei\&quot;,\n        newGasPrice: hardhat_1.ethers.utils.formatUnits(newGasPrice, \&quot;gwei\&quot;) + \&quot; gwei\&quot;\n    }\n});\n(0, chai_1.expect)(newBlock).to.be.gte(initialBlock);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8cce85db-0638-4ede-9253-02ae02ad47e9&quot;,&quot;parentUUID&quot;:&quot;6445c7cb-9c8d-48ee-86bb-194423aeef78&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;8cce85db-0638-4ede-9253-02ae02ad47e9&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1671,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;74bc1683-49c5-4483-a642-0cef379958b3&quot;,&quot;title&quot;:&quot;Transaction Persistence&quot;,&quot;fullFile&quot;:&quot;/Users/thanasornsawan/E2E_blockchain_testing/test/integration/NetworkConditionsTest.test.ts&quot;,&quot;file&quot;:&quot;/test/integration/NetworkConditionsTest.test.ts&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should handle transactions after node restart&quot;,&quot;fullTitle&quot;:&quot;Network Conditions Testing Transaction Persistence should handle transactions after node restart&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3678,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;context&quot;:&quot;[\n  {\n    \&quot;title\&quot;: \&quot;Transaction Persistence Test\&quot;,\n    \&quot;value\&quot;: \&quot;Testing transaction handling after node restart\&quot;\n  },\n  {\n    \&quot;title\&quot;: \&quot;Initial Transaction\&quot;,\n    \&quot;value\&quot;: {\n      \&quot;hash\&quot;: \&quot;0x5725f92ca5aa952d40e0458a32a813bf759517a7558cb65ac316874aee495177\&quot;,\n      \&quot;gasPrice\&quot;: \&quot;4.242009382 gwei\&quot;\n    }\n  },\n  {\n    \&quot;title\&quot;: \&quot;Reset Results\&quot;,\n    \&quot;value\&quot;: {\n      \&quot;transactionExistedBefore\&quot;: true,\n      \&quot;transactionExistsAfter\&quot;: false\n    }\n  }\n]&quot;,&quot;code&quot;:&quot;(0, addContext_1.default)(this, {\n    title: &#x27;Transaction Persistence Test&#x27;,\n    value: &#x27;Testing transaction handling after node restart&#x27;\n});\n// Get current gas price\nconst baseGasPrice = await hardhat_1.ethers.provider.getGasPrice();\nconsole.log(\&quot;Base gas price:\&quot;, hardhat_1.ethers.utils.formatUnits(baseGasPrice, \&quot;gwei\&quot;), \&quot;gwei\&quot;);\n// Create and send a transaction\nconst [signer] = await hardhat_1.ethers.getSigners();\nconst tx = await signer.sendTransaction({\n    to: hardhat_1.ethers.constants.AddressZero,\n    value: hardhat_1.ethers.utils.parseEther(\&quot;0.1\&quot;),\n    gasPrice: baseGasPrice.mul(2)\n});\nconst txHash = tx.hash;\n(0, addContext_1.default)(this, {\n    title: &#x27;Initial Transaction&#x27;,\n    value: {\n        hash: txHash,\n        gasPrice: hardhat_1.ethers.utils.formatUnits(baseGasPrice.mul(2), \&quot;gwei\&quot;) + \&quot; gwei\&quot;\n    }\n});\n// Verify transaction exists before reset\nconst txBefore = await hardhat_1.ethers.provider.getTransaction(txHash);\n(0, chai_1.expect)(txBefore).to.not.be.null;\n// Reset node\nawait hardhat_1.ethers.provider.send(\&quot;hardhat_reset\&quot;, [{\n        forking: {\n            jsonRpcUrl: process.env.MAINNET_RPC_URL,\n            blockNumber: await hardhat_1.ethers.provider.getBlockNumber()\n        }\n    }]);\n// Verify transaction doesn&#x27;t exist after reset\nconst txAfter = await hardhat_1.ethers.provider.getTransaction(txHash);\n(0, chai_1.expect)(txAfter).to.be.null;\n(0, addContext_1.default)(this, {\n    title: &#x27;Reset Results&#x27;,\n    value: {\n        transactionExistedBefore: !!txBefore,\n        transactionExistsAfter: !!txAfter\n    }\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;82bb1a8a-8904-468f-a39f-636fd982bc77&quot;,&quot;parentUUID&quot;:&quot;74bc1683-49c5-4483-a642-0cef379958b3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;82bb1a8a-8904-468f-a39f-636fd982bc77&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3678,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:40000}],&quot;meta&quot;:{&quot;mocha&quot;:{&quot;version&quot;:&quot;10.8.2&quot;},&quot;mochawesome&quot;:{&quot;options&quot;:{&quot;quiet&quot;:true,&quot;reportFilename&quot;:&quot;report&quot;,&quot;saveHtml&quot;:false,&quot;saveJson&quot;:true,&quot;consoleReporter&quot;:&quot;spec&quot;,&quot;useInlineDiffs&quot;:false,&quot;code&quot;:true},&quot;version&quot;:&quot;7.1.3&quot;},&quot;marge&quot;:{&quot;options&quot;:{&quot;id&quot;:&quot;default&quot;,&quot;reportDir&quot;:&quot;./test-reports&quot;,&quot;reportFilename&quot;:&quot;report&quot;,&quot;quiet&quot;:true,&quot;overwrite&quot;:true,&quot;html&quot;:false,&quot;json&quot;:true},&quot;version&quot;:&quot;6.2.0&quot;}}}" data-config="{&quot;reportFilename&quot;:&quot;report&quot;,&quot;reportDir&quot;:&quot;test-reports&quot;,&quot;reportTitle&quot;:&quot;E2E_blockchain_testing&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:false,&quot;enableCharts&quot;:false,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:false,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;test-reports/assets&quot;,&quot;htmlFile&quot;:&quot;/Users/thanasornsawan/E2E_blockchain_testing/test-reports/report.html&quot;}"><div id="report"></div><script src="assets/app.js"></script></body></html>